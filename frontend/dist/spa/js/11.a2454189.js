(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{c73f:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("breadcrumb",{attrs:{buttons:"",title:e.$parent.audit.name}}),i("div",{staticClass:"row q-col-gutter-md q-pa-md"},[i("div",{staticClass:"col-md-10 offset-md-1"},[i("q-table",{staticClass:"sticky-header-table-addfinding",attrs:{"card-class":"bg-grey-1","table-header-class":"bg-grey-1",columns:e.dtVulnHeaders,data:e.vulnerabilities,filter:e.search,"filter-method":e.customFilter,pagination:e.vulnPagination,"row-key":"_id",separator:"none",loading:e.loading},on:{"update:pagination":function(t){e.vulnPagination=t}},scopedSlots:e._u([{key:"top",fn:function(){return[i("q-select",{staticClass:"col-md-2",attrs:{label:"Language",options:e.languages,"option-value":"locale","option-label":"language","map-options":"","emit-value":"","options-sanitize":"",outlined:"","bg-color":"white"},on:{input:e.getVulnerabilities},model:{value:e.dtLanguage,callback:function(t){e.dtLanguage=t},expression:"dtLanguage"}}),i("q-space"),i("q-input",{staticClass:"q-pl-md col-md-6",attrs:{label:"Title",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addFinding()}},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-btn-dropdown",{attrs:{label:"Create","no-caps":"",flat:""}},[i("q-list",{attrs:{separator:""}},[i("q-item-label",{attrs:{header:""}},[e._v("Select category")]),i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){return e.addFinding()}}},[i("q-item-section",[i("q-item-label",[e._v("No Category")])],1)],1),e._l(e.vulnCategories,(function(t){return i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:t.name,attrs:{clickable:""},on:{click:function(i){return e.addFinding(t)}}},[i("q-item-section",[i("q-item-label",[e._v(e._s(t.name))])],1)],1)}))],2)],1)]},proxy:!0}]),model:{value:e.findingTitle,callback:function(t){e.findingTitle=t},expression:"findingTitle"}})]},proxy:!0},{key:"top-row",fn:function(t){return[i("q-tr",[i("q-td",{staticStyle:{width:"60%"}},[i("q-input",{attrs:{dense:"",color:"secondary",label:"Search...",clearable:"",outlined:"","bg-color":"white"},model:{value:e.search.title,callback:function(t){e.$set(e.search,"title",t)},expression:"search.title"}})],1),i("q-td",{staticStyle:{width:"20%"}},[i("q-select",{attrs:{dense:"",color:"secondary",label:"Search...",clearable:"",options:e.vulnCategoriesOptions,"options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.search.category,callback:function(t){e.$set(e.search,"category",t)},expression:"search.category"}})],1),i("q-td",{staticStyle:{width:"20%"}},[i("q-select",{attrs:{dense:"",color:"secondary",label:"Search...",clearable:"",options:e.vulnTypeOptions,"options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.search.vulnType,callback:function(t){e.$set(e.search,"vulnType",t)},expression:"search.vulnType"}})],1),i("q-td")],1)]}},{key:"body",fn:function(t){return[i("q-tr",{attrs:{props:t}},[i("q-td",{key:"title",attrs:{props:t}},[e._v("\n                        "+e._s(t.row.detail.title)+"\n                        "),i("q-btn",{attrs:{dense:"",round:"",flat:"",icon:t.expand?"arrow_drop_up":"arrow_drop_down"},on:{click:function(e){t.expand=!t.expand}}})],1),i("q-td",{key:"category",attrs:{props:t}},[e._v("\n                        "+e._s(t.row.category||"No Category")+"\n                    ")]),i("q-td",{key:"vulnType",attrs:{props:t}},[e._v("\n                        "+e._s(t.row.detail.vulnType||"Undefined")+"\n                    ")]),i("q-td",{key:"action",staticStyle:{width:"1px"},attrs:{props:t}},[i("q-btn",{attrs:{flat:"",color:"primary",icon:"fa fa-plus-circle"},on:{click:function(i){return e.addFindingFromVuln(t.row)}}},[i("q-tooltip",{attrs:{anchor:"bottom middle",self:"center left",delay:500,"content-class":"text-bold"}},[e._v("Add to Findings")])],1)],1)],1),i("q-tr",{directives:[{name:"show",rawName:"v-show",value:t.expand,expression:"props.expand"}],attrs:{props:t}},[i("q-td",{staticClass:"bg-grey-4",attrs:{colspan:"100%"}},[i("div",{staticClass:"editor__content",staticStyle:{"white-space":"initial"},domProps:{innerHTML:e._s(e.htmlEncode(t.row.detail.description))}})])],1)]}},{key:"bottom",fn:function(t){return[1===e.vulnerabilities.length?i("span",[e._v(e._s(e.filteredRowsCount)+" / 1 Vulnerability")]):i("span",[e._v(e._s(e.filteredRowsCount)+" / "+e._s(e.vulnerabilities.length)+" Vulnerabilities")]),i("q-space"),i("span",[e._v("Results per page:")]),i("q-select",{staticClass:"q-px-md",attrs:{options:e.rowsPerPageOptions,"emit-value":"","map-options":"",dense:"","options-dense":"","options-cover":"",borderless:""},model:{value:e.vulnPagination.rowsPerPage,callback:function(t){e.$set(e.vulnPagination,"rowsPerPage",t)},expression:"vulnPagination.rowsPerPage"}}),i("q-pagination",{attrs:{input:"",max:t.pagesNumber},model:{value:e.vulnPagination.page,callback:function(t){e.$set(e.vulnPagination,"page",t)},expression:"vulnPagination.page"}})]}}])})],1)])],1)},a=[],o=(i("d81d"),i("c740"),i("4de4"),i("ac1f"),i("5319"),i("a4d3"),i("e01a"),i("b0c0"),i("2a19")),l=i("b3a4"),s=i("1938"),r=i("99ec"),c=i("ed8e"),d=i("6fbe"),u={data:function(){return{finding:{},findingTitle:"",vulnerabilities:[],loading:!0,dtVulnHeaders:[{name:"title",label:"Title",field:function(e){return e.detail.title},align:"left",sortable:!0},{name:"category",label:"Category",field:"category",align:"left",sortable:!0},{name:"vulnType",label:"Type",field:function(e){return e.detail.vulnType},align:"left",sortable:!0},{name:"action",label:"",field:"action",align:"left",sortable:!1}],vulnPagination:{page:1,rowsPerPage:25,sortBy:"title"},rowsPerPageOptions:[{label:"25",value:25},{label:"50",value:50},{label:"100",value:100},{label:"All",value:0}],filteredRowsCount:0,search:{title:"",vulnType:"",category:""},languages:[],dtLanguage:"",currentExpand:-1,vulnCategories:[],htmlEncode:d["a"].htmlEncode}},components:{Breadcrumb:l["a"]},mounted:function(){this.auditId=this.$route.params.auditId,this.getLanguages(),this.dtLanguage=this.$parent.audit.language,this.getVulnerabilities(),this.getVulnerabilityCategories(),this.$socket.emit("menu",{menu:"addFindings",room:this.auditId})},computed:{vulnCategoriesOptions:function(){return this.$_.uniq(this.$_.map(this.vulnerabilities,(function(e){return e.category||"No Category"})))},vulnTypeOptions:function(){return this.$_.uniq(this.$_.map(this.vulnerabilities,(function(e){return e.detail.vulnType||"Undefined"})))}},methods:{getLanguages:function(){var e=this;c["a"].getLanguages().then((function(t){e.languages=t.data.datas})).catch((function(e){console.log(e)}))},getVulnerabilities:function(){var e=this;this.loading=!0,s["a"].getVulnByLanguage(this.dtLanguage).then((function(t){e.vulnerabilities=t.data.datas,e.loading=!1})).catch((function(e){console.log(e)}))},getVulnerabilityCategories:function(){var e=this;c["a"].getVulnerabilityCategories().then((function(t){e.vulnCategories=t.data.datas})).catch((function(e){console.log(e)}))},getDtTitle:function(e){var t=this,i=e.details.findIndex((function(e){return e.locale===t.dtLanguage.locale}));return i<0?"Not defined for this language yet":e.details[i].title},customFilter:function(e,t,i,n){var a=e&&e.filter((function(e){var i=(e.detail.title||"Not defined for this language").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),n=(e.detail.vulnType||"Undefined").toLowerCase(),a=(e.category||"No Category").toLowerCase(),o=(t.title||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),l=(t.category||"").toLowerCase(),s=(t.vulnType||"").toLowerCase();return i.indexOf(o)>-1&&n.indexOf(s)>-1&&a.indexOf(l)>-1}));return this.filteredRowsCount=a.length,this.filteredRows=a,a},addFindingFromVuln:function(e){var t=this,i=null;e&&(i={title:e.detail.title,vulnType:e.detail.vulnType,description:e.detail.description,observation:e.detail.observation,remediation:e.detail.remediation,remediationComplexity:e.remediationComplexity,priority:e.priority,references:e.detail.references,cvssv3:e.cvssv3,cvssScore:e.cvssScore?e.cvssScore:"0",cvssSeverity:e.cvssSeverity?e.cvssSeverity:"None",category:e.category,customFields:e.detail.customFields}),i&&r["a"].createFinding(this.auditId,i).then((function(){t.findingTitle="",o["a"].create({message:"Finding created successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){o["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},addFinding:function(e){var t=this,i=null;e&&this.findingTitle?i={title:this.findingTitle,vulnType:"",description:"",observation:"",remediation:"",remediationComplexity:"",priority:"",references:[],cvssv3:"",cvssScore:0,cvssSeverity:"None",category:e.name,customFields:e.fields||[]}:this.findingTitle&&(i={title:this.findingTitle,vulnType:"",description:"",observation:"",remediation:"",remediationComplexity:"",priority:"",references:[],cvssv3:"",cvssScore:0,cvssSeverity:"None"}),i&&r["a"].createFinding(this.auditId,i).then((function(){t.findingTitle="",o["a"].create({message:"Finding created successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){o["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))}}},p=u,g=i("2877"),f=Object(g["a"])(p,n,a,!1,null,null,null);t["default"]=f.exports}}]);