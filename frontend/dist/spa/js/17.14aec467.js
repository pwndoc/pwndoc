(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[17],{9880:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-10 col-12 offset-md-1 q-mt-md"},[n("q-table",{staticClass:"sticky-header-table",attrs:{"card-class":"bg-grey-1","table-header-class":"bg-grey-1",columns:e.dtHeaders,data:e.clients,filter:e.search,"filter-method":e.customFilter,pagination:e.pagination,"row-key":"email",loading:e.loading},on:{"update:pagination":function(t){e.pagination=t},"row-dblclick":e.dblClick},scopedSlots:e._u([{key:"top",fn:function(){return[n("q-space"),n("q-btn",{attrs:{unelevated:"",label:"Add Client",color:"secondary","no-caps":""},on:{click:function(t){e.cleanCurrentClient(),e.$refs.createModal.show()}}})]},proxy:!0},{key:"top-row",fn:function(t){return[n("q-tr",[n("q-td",{staticStyle:{width:"25%"}},[n("q-input",{attrs:{dense:"",color:"secondary",label:"Search...",clearable:"",outlined:"","bg-color":"white"},model:{value:e.search.firstname,callback:function(t){e.$set(e.search,"firstname",t)},expression:"search.firstname"}})],1),n("q-td",{staticStyle:{width:"25%"}},[n("q-input",{attrs:{dense:"",color:"secondary",label:"Search...",clearable:"",outlined:"","bg-color":"white"},model:{value:e.search.lastname,callback:function(t){e.$set(e.search,"lastname",t)},expression:"search.lastname"}})],1),n("q-td",{staticStyle:{width:"25%"}},[n("q-input",{attrs:{dense:"",color:"secondary",label:"Search...",clearable:"",outlined:"","bg-color":"white"},model:{value:e.search.email,callback:function(t){e.$set(e.search,"email",t)},expression:"search.email"}})],1),n("q-td",{staticStyle:{width:"25%"}},[n("q-select",{attrs:{dense:"",color:"secondary",label:"Search...",clearable:"",options:e.companies,"option-value":"name","option-label":"name","map-options":"","emit-value":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.search["company.name"],callback:function(t){e.$set(e.search,"company.name",t)},expression:"search['company.name']"}})],1),n("q-td")],1)]}},{key:"body-cell-action",fn:function(t){return n("q-td",{staticStyle:{width:"1px"}},[n("q-btn",{attrs:{size:"sm",flat:"",color:"primary",icon:"fa fa-edit"},on:{click:function(n){e.clone(t.row),e.$refs.editModal.show()}}},[n("q-tooltip",{attrs:{anchor:"bottom middle",self:"center left",delay:500,"content-class":"text-bold"}},[e._v("Edit")])],1),n("q-btn",{attrs:{size:"sm",flat:"",color:"negative",icon:"fa fa-trash"},on:{click:function(n){return e.confirmDeleteClient(t.row)}}},[n("q-tooltip",{attrs:{anchor:"bottom middle",self:"center left",delay:500,"content-class":"text-bold"}},[e._v("Delete")])],1)],1)}},{key:"bottom",fn:function(t){return[1===e.clients.length?n("span",[e._v("1 Client")]):n("span",[e._v(e._s(e.clients.length)+" Clients")]),n("q-space"),n("span",[e._v("Results per page:")]),n("q-select",{staticClass:"q-px-md",attrs:{options:e.rowsPerPageOptions,"emit-value":"","map-options":"",dense:"","options-dense":"","options-cover":"",borderless:""},model:{value:e.pagination.rowsPerPage,callback:function(t){e.$set(e.pagination,"rowsPerPage",t)},expression:"pagination.rowsPerPage"}}),n("q-pagination",{attrs:{input:"",max:t.pagesNumber},model:{value:e.pagination.page,callback:function(t){e.$set(e.pagination,"page",t)},expression:"pagination.page"}})]}}])})],1)]),n("q-dialog",{ref:"createModal",attrs:{persistent:""},on:{hide:function(t){return e.cleanErrors()}}},[n("q-card",{staticClass:"bg-grey-1",staticStyle:{width:"800px"},attrs:{persistent:""}},[n("q-bar",{staticClass:"bg-primary text-white"},[n("span",[e._v("Add Client")]),n("q-space"),n("q-btn",{attrs:{dense:"",flat:"",icon:"close"},on:{click:function(t){return e.$refs.createModal.hide()}}})],1),n("q-card-section",[n("q-select",{attrs:{label:"Company","stack-label":"",clearable:"",options:e.companies,"option-value":"name","option-label":"name","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.currentClient.company,callback:function(t){e.$set(e.currentClient,"company",t)},expression:"currentClient.company"}})],1),n("q-card-section",[n("q-input",{attrs:{autofocus:"",label:"Firstname *",error:!!e.errors.firstname,"error-message":e.errors.firstname,"hide-bottom-space":"",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createClient()}},model:{value:e.currentClient.firstname,callback:function(t){e.$set(e.currentClient,"firstname",t)},expression:"currentClient.firstname"}})],1),n("q-card-section",[n("q-input",{attrs:{label:"Lastname *",error:!!e.errors.lastname,"error-message":e.errors.lastname,"hide-bottom-space":"",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createClient()}},model:{value:e.currentClient.lastname,callback:function(t){e.$set(e.currentClient,"lastname",t)},expression:"currentClient.lastname"}})],1),n("q-card-section",[n("q-input",{attrs:{label:"Email *",error:!!e.errors.email,"error-message":e.errors.email,"hide-bottom-space":"",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createClient()}},model:{value:e.currentClient.email,callback:function(t){e.$set(e.currentClient,"email",t)},expression:"currentClient.email"}})],1),n("q-card-section",[n("q-input",{attrs:{label:"Function",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createClient()}},model:{value:e.currentClient.title,callback:function(t){e.$set(e.currentClient,"title",t)},expression:"currentClient.title"}})],1),n("q-card-section",[n("q-input",{attrs:{label:"Phone",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createClient()}},model:{value:e.currentClient.phone,callback:function(t){e.$set(e.currentClient,"phone",t)},expression:"currentClient.phone"}})],1),n("q-card-section",[n("q-input",{attrs:{label:"Cell",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createClient()}},model:{value:e.currentClient.cell,callback:function(t){e.$set(e.currentClient,"cell",t)},expression:"currentClient.cell"}})],1),n("q-separator"),n("q-card-actions",{attrs:{align:"right"}},[n("q-btn",{attrs:{color:"primary",outline:""},on:{click:function(t){return e.$refs.createModal.hide()}}},[e._v("Cancel")]),n("q-btn",{attrs:{color:"secondary",unelevated:""},on:{click:function(t){return e.createClient()}}},[e._v("Create")])],1)],1)],1),n("q-dialog",{ref:"editModal",attrs:{persistent:""},on:{hide:function(t){return e.cleanErrors()}}},[n("q-card",{staticClass:"bg-grey-1",staticStyle:{width:"800px"},attrs:{persistent:""}},[n("q-bar",{staticClass:"bg-primary text-white"},[n("span",[e._v("Edit Client")]),n("q-space"),n("q-btn",{attrs:{dense:"",flat:"",icon:"close"},on:{click:function(t){return e.$refs.editModal.hide()}}})],1),n("q-card-section",[n("q-select",{attrs:{label:"Company","stack-label":"",clearable:"",options:e.companies,"option-value":"name","option-label":"name","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.currentClient.company,callback:function(t){e.$set(e.currentClient,"company",t)},expression:"currentClient.company"}})],1),n("q-card-section",[n("q-input",{attrs:{label:"Firstname *",error:!!e.errors.firstname,"error-message":e.errors.firstname,"hide-bottom-space":"",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateClient()}},model:{value:e.currentClient.firstname,callback:function(t){e.$set(e.currentClient,"firstname",t)},expression:"currentClient.firstname"}})],1),n("q-card-section",[n("q-input",{ref:"lastnameInput",attrs:{label:"Lastname *",error:!!e.errors.lastname,"error-message":e.errors.lastname,"hide-bottom-space":"",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateClient()}},model:{value:e.currentClient.lastname,callback:function(t){e.$set(e.currentClient,"lastname",t)},expression:"currentClient.lastname"}})],1),n("q-card-section",[n("q-input",{attrs:{label:"Email *",error:!!e.errors.email,"error-message":e.errors.email,"hide-bottom-space":"",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateClient()}},model:{value:e.currentClient.email,callback:function(t){e.$set(e.currentClient,"email",t)},expression:"currentClient.email"}})],1),n("q-card-section",[n("q-input",{attrs:{label:"Function",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateClient()}},model:{value:e.currentClient.title,callback:function(t){e.$set(e.currentClient,"title",t)},expression:"currentClient.title"}})],1),n("q-card-section",[n("q-input",{attrs:{label:"Phone",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateClient()}},model:{value:e.currentClient.phone,callback:function(t){e.$set(e.currentClient,"phone",t)},expression:"currentClient.phone"}})],1),n("q-card-section",[n("q-input",{attrs:{label:"Cell",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateClient()}},model:{value:e.currentClient.cell,callback:function(t){e.$set(e.currentClient,"cell",t)},expression:"currentClient.cell"}})],1),n("q-separator"),n("q-card-actions",{attrs:{align:"right"}},[n("q-btn",{attrs:{color:"primary",outline:""},on:{click:function(t){return e.$refs.editModal.hide()}}},[e._v("Cancel")]),n("q-btn",{attrs:{color:"secondary",unelevated:""},on:{click:function(t){return e.updateClient()}}},[e._v("Update")])],1)],1)],1)],1)},a=[],i=(n("b0c0"),n("436b")),l=n("2a19"),o=n("872f"),s=n("e3fa"),c=n("6fbe"),u={data:function(){return{clients:[],loading:!0,companies:[],dtHeaders:[{name:"firstname",label:"Firstname",field:"firstname",align:"left",sortable:!0},{name:"lastname",label:"Lastname",field:"lastname",align:"left",sortable:!0},{name:"email",label:"Email",field:"email",align:"left",sortable:!0},{name:"company",label:"Company",field:function(e){return e.company?e.company.name:""},align:"left",sortable:!0},{name:"action",label:"",field:"action",align:"left",sortable:!1}],pagination:{page:1,rowsPerPage:25,sortBy:"firstname"},rowsPerPageOptions:[{label:"25",value:25},{label:"50",value:50},{label:"100",value:100},{label:"All",value:0}],search:{firstname:"",lastname:"",email:"","company.name":""},customFilter:c["a"].customFilter,errors:{lastname:"",firstname:"",email:""},currentClient:{lastname:"",firstname:"",email:"",phone:"",cell:"",title:"",company:{}},idUpdate:""}},mounted:function(){this.getClients(),this.getCompanies()},methods:{getClients:function(){var e=this;this.loading=!0,o["a"].getClients().then((function(t){e.clients=t.data.datas,e.loading=!1})).catch((function(e){console.log(e)}))},createClient:function(){var e=this;this.cleanErrors(),this.currentClient.lastname||(this.errors.lastname="Lastname required"),this.currentClient.firstname||(this.errors.firstname="Firstname required"),this.currentClient.email||(this.errors.email="Email required"),this.errors.lastname||this.errors.firstname||this.errors.email||o["a"].createClient(this.currentClient).then((function(){e.getClients(),e.$refs.createModal.hide(),l["a"].create({message:"Client created successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){l["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},updateClient:function(){var e=this;this.cleanErrors(),this.currentClient.lastname||(this.errors.lastname="Lastname required"),this.currentClient.firstname||(this.errors.firstname="Firstname required"),this.currentClient.email||(this.errors.email="Email required"),this.errors.lastname||this.errors.firstname||this.errors.email||o["a"].updateClient(this.idUpdate,this.currentClient).then((function(){e.getClients(),e.$refs.editModal.hide(),l["a"].create({message:"Client updated successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){l["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},deleteClient:function(e){var t=this;o["a"].deleteClient(e).then((function(){t.getClients(),l["a"].create({message:"Client deleted successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){l["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},confirmDeleteClient:function(e){var t=this;i["a"].create({title:"Confirm Suppression",message:"Client «".concat(e.name,"» will be permanently deleted"),ok:{label:"Confirm",color:"negative"},cancel:{label:"Cancel",color:"white"}}).onOk((function(){return t.deleteClient(e._id)}))},getCompanies:function(){var e=this;s["a"].getCompanies().then((function(t){e.companies=t.data.datas})).catch((function(e){console.log(e)}))},clone:function(e){this.currentClient=this.$_.clone(e),this.idUpdate=e._id},cleanErrors:function(){this.errors.lastname="",this.errors.firstname="",this.errors.email=""},cleanCurrentClient:function(){this.currentClient.lastname="",this.currentClient.firstname="",this.currentClient.email="",this.currentClient.phone="",this.currentClient.cell="",this.currentClient.title="",this.currentClient.company={name:""}},dblClick:function(e,t){this.clone(t),this.$refs.editModal.show()}}},d=u,m=n("2877"),p=Object(m["a"])(d,r,a,!1,null,null,null);t["default"]=p.exports}}]);