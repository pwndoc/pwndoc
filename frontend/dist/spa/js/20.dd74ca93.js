(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[20],{2102:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-10 col-12 offset-md-1 q-mt-md"},[a("q-card",[a("q-card-section",{staticClass:"q-py-xs bg-blue-grey-5 text-white"},[a("div",{staticClass:"text-h6"},[e._v("Vulnerabilities")])]),a("q-separator"),e.UserService.isAllowed("vulnerabilities:create")?a("div",[a("q-card-section",[a("div",{staticClass:"text-bold"},[e._v("Import Vulnerabilities")])]),a("q-card-section",[a("div",{staticClass:"text-grey-8"},[e._v("\n                        Import Vulnerabilities from a .yml or .json file. (Serpico format accepted)"),a("br"),e._v("\n                        This allows you to easily import a batch of vulnerabilities templates.\n                    ")])]),a("q-card-section",[a("input",{ref:"importVulnerabilities",staticClass:"hidden",attrs:{value:"",type:"file",multiple:"",accept:".yml, .json"},on:{change:function(t){return e.importVulnerabilities(t.target.files)}}}),a("q-btn",{staticClass:"bg-secondary text-white",attrs:{label:"Import",color:"secondary",flat:""},on:{click:function(t){return e.$refs.importVulnerabilities.click()}}})],1),a("q-separator")],1):e._e(),a("q-card-section",[a("div",{staticClass:"text-bold"},[e._v("Export Vulnerabilities")])]),a("q-card-section",[a("div",{staticClass:"text-grey-8"},[e._v("Export Vulnerabilities to yaml format. This export can easily be re-imported afterward")])]),a("q-card-section",[a("q-btn",{staticClass:"bg-secondary text-white",attrs:{label:"Export",color:"secondary",flat:""},on:{click:e.getVulnerabilities}})],1),a("q-separator"),e.UserService.isAllowed("vulnerabilities:delete-all")?a("div",[a("q-card-section",[a("div",{staticClass:"text-bold"},[e._v("Delete All Vulnerabilities")])]),a("q-card-section",[a("div",{staticClass:"text-grey-8"},[e._v("\n                            Delete all existing vulnerabilities."),a("br"),a("strong",[e._v("This action is definitive!!")])])]),a("q-card-section",[a("q-btn",{staticClass:"bg-negative text-white",attrs:{label:"Delete All",flat:""},on:{click:e.deleteAllVulnerabilities}})],1)],1):e._e()],1)],1),a("div",{staticClass:"col-md-10 col-12 offset-md-1 q-mt-md"},[a("q-card",[a("q-card-section",{staticClass:"q-py-xs bg-blue-grey-5 text-white"},[a("div",{staticClass:"text-h6"},[e._v("Audits")])]),a("q-separator"),a("q-card-section",[e._v("\n                TODO\n            ")])],1)],1)])])},r=[],l=a("7037"),s=a.n(l),n=(a("99af"),a("ac1f"),a("1276"),a("b0c0"),a("159b"),a("5319"),a("4de4"),a("e260"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("436b")),o=a("2a19"),c=a("651e"),d=a.n(c),p=a("1938"),u=a("93d6"),v={data:function(){return{UserService:u["a"],vulnerabilities:[]}},mounted:function(){},methods:{getVulnerabilities:function(){var e=this;this.vulnerabilities=[],p["a"].exportVulnerabilities().then((function(t){e.vulnerabilities=t.data.datas,e.downloadVulnerabilities()})).catch((function(e){o["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},createVulnerabilities:function(){p["a"].createVulnerabilities(this.vulnerabilities).then((function(e){var t="",a="positive";0===e.data.datas.duplicates?t="All <strong>".concat(e.data.datas.created,"</strong> vulnerabilities created"):0===e.data.datas.created&&e.data.datas.duplicates>0?(t="All <strong>".concat(e.data.datas.duplicates.length,"</strong> vulnerabilities title already exist"),a="negative"):(t="<strong>".concat(e.data.datas.created,"</strong> vulnerabilities created<br /><strong>").concat(e.data.datas.duplicates.length,"</strong> vulnerabilities title already exist"),a="orange"),o["a"].create({message:t,html:!0,closeBtn:"x",color:a,textColor:"white",position:"top-right"})})).catch((function(e){o["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},importVulnerabilities:function(e){var t=this;this.vulnerabilities=[];for(var a=0,i=0;i<e.length;i++)(function(e){var i=new FileReader;i.onloadend=function(r){var l,n=e.name.split(".").pop();if("yml"===n)try{if(l=d.a.safeLoad(i.result),"object"!==s()(l))throw new Error("Invalid YAML format detected");Array.isArray(l)?(l.forEach((function(e){Array.isArray(e.references)&&e.references.length>0&&e.details.forEach((function(t){Array.isArray(t.references)&&0!=t.references.length||(t.references=e.references)}))})),t.vulnerabilities=l):t.vulnerabilities.push(l)}catch(p){console.log(p);var c=p;return p.mark&&(c="Parsing Error: line ".concat(p.mark.line,", column: ").concat(p.mark.column)),void o["a"].create({message:c,color:"negative",textColor:"white",position:"top-right"})}else if("json"===n)try{if(l=JSON.parse(i.result),"object"!==s()(l))throw new Error("Invalid JSON format detected");Array.isArray(l)?l.length>0&&l[0].id?t.vulnerabilities=t.parseSerpico(l):t.vulnerabilities=l:t.vulnerabilities.push(l)}catch(p){console.log(p);c=p;return p.message&&(c="Parsing Error: ".concat(p.message)),void o["a"].create({message:c,color:"negative",textColor:"white",position:"top-right"})}else console.log("Bad Extension");a--,0===a&&t.createVulnerabilities()},a++,i.readAsText(e)})(e[i])},parseSerpico:function(e){var t=this,a=[];return e.forEach((function(e){var i={};i.cvssv3=e.c3_vs||null,i.cvssScore=e.cvss_base_score||null,i.cvssSeverity=e.severity||null,i.priority=null,i.remediationComplexity=null;var r={};r.locale=t.formatSerpicoText(e.language)||"en",r.title=t.formatSerpicoText(e.title),r.vulnType=t.formatSerpicoText(e.type),r.description=t.formatSerpicoText(e.overview),r.observation=t.formatSerpicoText(e.poc),r.remediation=t.formatSerpicoText(e.remediation),r.references=[],e.references&&""!==e.references&&(e.references=e.references.replace(/<paragraph>/g,""),r.references=e.references.split("</paragraph>").filter(Boolean)),i.details=[r],a.push(i)})),a},formatSerpicoText:function(e){if(!e)return null;if("English"===e)return"en";if("French"===e)return"fr";var t=e;return t=t.replace(/<h4>/g,"<b>"),t=t.replace(/<\/h4>/g,"</b>"),t=t.replace(/<paragraph><bullet>/g,"<li><p>"),t=t.replace(/<\/bullet><\/paragraph>/g,"</p></li>"),t=t.replace(/<paragraph><bullet1>/g,"<li><p>"),t=t.replace(/<\/bullet1><\/paragraph>/g,"</p></li>"),t=t.replace(/<paragraph>/g,"<p>"),t=t.replace(/<\/paragraph>/g,"</p>"),t=t.replace(/<indented>/g,"    "),t=t.replace(/<\/indented>/g,""),t=t.replace(/<italics>/g,"<i>"),t=t.replace(/<\/italics>/g,"</i>"),t=t.replace(/\[\[\[/g,"<pre><code>"),t=t.replace(/]]]/g,"</code></pre>"),t=this.$_.unescape(t),t=t.replace(/\n$/,""),t},downloadVulnerabilities:function(){var e=d.a.safeDump(this.vulnerabilities),t=new Blob([e],{type:"application/yaml"}),a=URL.createObjectURL(t),i=document.createElement("a");i.href=a,i.download="vulnerabilities.yml",document.body.appendChild(i),i.click(),URL.revokeObjectURL(a),document.body.removeChild(i)},deleteAllVulnerabilities:function(){n["a"].create({title:"Confirm Suppression",message:"All Vulnerabilities will be permanently deleted",ok:{label:"Confirm",color:"negative"},cancel:{label:"Cancel",color:"white"}}).onOk((function(){p["a"].deleteAllVulnerabilities().then((function(){o["a"].create({message:"All vulnerabilities deleted successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){o["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))}))}}},b=v,f=a("2877"),g=Object(f["a"])(b,i,r,!1,null,null,null);t["default"]=g.exports}}]);