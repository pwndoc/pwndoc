(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[22],{bd5e:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-10 col-12 offset-md-1 q-mt-md"},[a("q-table",{staticClass:"sticky-header-table",attrs:{"card-class":"bg-grey-1","table-header-class":"bg-grey-1",columns:e.dtHeaders,data:e.templates,filter:e.search,"filter-method":e.customFilter,pagination:e.pagination,"row-key":"name",loading:e.loading},on:{"update:pagination":function(t){e.pagination=t},"row-dblclick":e.dblClick},scopedSlots:e._u([{key:"top",fn:function(){return[a("q-space"),e.UserService.isAllowed("templates:create")?a("q-btn",{attrs:{unelevated:"",label:"Create Template",color:"secondary","no-caps":""},on:{click:function(t){e.cleanCurrentTemplate,e.$refs.createModal.show()}}}):e._e()]},proxy:!0},{key:"top-row",fn:function(t){return[a("q-tr",[a("q-td",{staticStyle:{width:"50%"}},[a("q-input",{attrs:{dense:"",color:"secondary",label:"Search...",clearable:"",outlined:"","bg-color":"white"},model:{value:e.search.name,callback:function(t){e.$set(e.search,"name",t)},expression:"search.name"}})],1),a("q-td",{staticStyle:{width:"50%"}},[a("q-input",{attrs:{dense:"",color:"secondary",label:"Search...",clearable:"",outlined:"","bg-color":"white"},model:{value:e.search.ext,callback:function(t){e.$set(e.search,"ext",t)},expression:"search.ext"}})],1),a("q-td")],1)]}},{key:"body-cell-action",fn:function(t){return a("q-td",{staticStyle:{width:"1px"}},[e.UserService.isAllowed("templates:update")?a("q-btn",{attrs:{size:"sm",flat:"",color:"primary",icon:"fa fa-edit"},on:{click:function(a){e.clone(t.row),e.$refs.editModal.show()}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"center left",delay:500,"content-class":"text-bold"}},[e._v("Edit")])],1):e._e(),a("q-btn",{attrs:{size:"sm",flat:"",color:"info",icon:"fa fa-download"},on:{click:function(a){return e.downloadTemplate(t.row)}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"center left",delay:500,"content-class":"text-bold"}},[e._v("Download")])],1),e.UserService.isAllowed("templates:delete")?a("q-btn",{attrs:{size:"sm",flat:"",color:"negative",icon:"fa fa-trash"},on:{click:function(a){return e.confirmDeleteTemplate(t.row)}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"center left",delay:500,"content-class":"text-bold"}},[e._v("Delete")])],1):e._e()],1)}},{key:"bottom",fn:function(t){return[1===e.templates.length?a("span",[e._v("1 Template")]):a("span",[e._v(e._s(e.templates.length)+" Templates")]),a("q-space"),a("span",[e._v("Results per page:")]),a("q-select",{staticClass:"q-px-md",attrs:{options:e.rowsPerPageOptions,"emit-value":"","map-options":"",dense:"","options-dense":"","options-cover":"",borderless:""},model:{value:e.pagination.rowsPerPage,callback:function(t){e.$set(e.pagination,"rowsPerPage",t)},expression:"pagination.rowsPerPage"}}),a("q-pagination",{attrs:{input:"",max:t.pagesNumber},model:{value:e.pagination.page,callback:function(t){e.$set(e.pagination,"page",t)},expression:"pagination.page"}})]}}])})],1)]),a("q-dialog",{ref:"createModal",attrs:{persistent:""},on:{hide:function(t){return e.cleanCurrentTemplate()}}},[a("q-card",{staticClass:"bg-grey-1",staticStyle:{width:"800px"}},[a("q-bar",{staticClass:"bg-primary text-white"},[a("div",{staticClass:"q-toolbar-title"},[e._v("\n                Create Template\n            ")]),a("q-space"),a("q-btn",{attrs:{dense:"",flat:"",icon:"close"},on:{click:function(t){return e.$refs.createModal.hide()}}})],1),a("q-card-section",[a("div",{staticClass:"row"},[a("q-input",{staticClass:"col-md-12 col-12",attrs:{label:"Name *",autofocus:"","stack-label":"",error:!!e.errors.name,"error-message":e.errors.name,outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createTemplate()}},model:{value:e.currentTemplate.name,callback:function(t){e.$set(e.currentTemplate,"name",t)},expression:"currentTemplate.name"}}),a("q-field",{staticClass:"col-md-12 col-12",attrs:{"no-error-icon":"",borderless:"",error:!!e.errors.file,"error-message":e.errors.file},scopedSlots:e._u([{key:"control",fn:function(){return[a("q-uploader",{staticClass:"col-md-12 col-12",attrs:{label:"File *",accept:".doc,.docx,.docm,.ppt,.pptx","hide-upload-btn":""},on:{added:e.handleFile}})]},proxy:!0}])})],1)]),a("q-separator"),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",outline:""},on:{click:function(t){return e.$refs.createModal.hide()}}},[e._v("Cancel")]),a("q-btn",{attrs:{color:"secondary",unelevated:""},on:{click:function(t){return e.createTemplate()}}},[e._v("Create")])],1)],1)],1),a("q-dialog",{ref:"editModal",attrs:{persistent:""},on:{hide:function(t){return e.cleanCurrentTemplate()}}},[a("q-card",{staticClass:"bg-grey-1",staticStyle:{width:"800px"}},[a("q-bar",{staticClass:"bg-primary text-white"},[a("div",{staticClass:"q-toolbar-title"},[e._v("\n                Edit Template\n            ")]),a("q-space"),a("q-btn",{attrs:{dense:"",flat:"",icon:"close"},on:{click:function(t){return e.$refs.editModal.hide()}}})],1),a("q-card-section",[a("div",{staticClass:"row"},[a("q-input",{staticClass:"col-md-12 col-12",attrs:{label:"Name *",autofocus:"","stack-label":"",error:!!e.errors.name,"error-message":e.errors.name,outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateTemplate()}},model:{value:e.currentTemplate.name,callback:function(t){e.$set(e.currentTemplate,"name",t)},expression:"currentTemplate.name"}}),a("q-field",{staticClass:"col-md-12 col-12",attrs:{"no-error-icon":"",borderless:"",error:!!e.errors.file,"error-message":e.errors.file},scopedSlots:e._u([{key:"control",fn:function(){return[a("q-uploader",{staticClass:"col-md-12",attrs:{label:"File *",accept:".doc,.docx,.docm,.ppt,.pptx","hide-upload-btn":""},on:{added:e.handleFile}})]},proxy:!0}])})],1)]),a("q-separator"),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",outline:""},on:{click:function(t){return e.$refs.editModal.hide()}}},[e._v("Cancel")]),a("q-btn",{attrs:{color:"secondary",unelevated:""},on:{click:function(t){return e.updateTemplate()}}},[e._v("Update")])],1)],1)],1)],1)},o=[],n=(a("99af"),a("b0c0"),a("ac1f"),a("1276"),a("436b")),l=a("2a19"),s=a("a357"),i=a("b3a4"),c=a("b0f9"),d=a("93d6"),p=a("6fbe"),m={data:function(){return{UserService:d["a"],templates:[],loading:!0,dtHeaders:[{name:"name",label:"Name",field:"name",align:"left",sortable:!0},{name:"ext",label:"Extension",field:"ext",align:"left",sortable:!0},{name:"action",label:"",field:"action",align:"left",sortable:!1}],pagination:{page:1,rowsPerPage:25,sortBy:"name"},rowsPerPageOptions:[{label:"25",value:25},{label:"50",value:50},{label:"100",value:100},{label:"All",value:0}],search:{name:"",ext:""},customFilter:p["a"].customFilter,errors:{name:"",file:""},currentTemplate:{name:"",file:"",ext:""},templateId:""}},components:{Breadcrumb:i["a"]},mounted:function(){this.getTemplates()},methods:{getTemplates:function(){var e=this;this.loading=!0,c["a"].getTemplates().then((function(t){e.templates=t.data.datas,e.loading=!1})).catch((function(e){console.log(e)}))},downloadTemplate:function(e){c["a"].downloadTemplate(e._id).then((function(t){if(status=Object(s["a"])("".concat(e.name,".").concat(e.ext||"docx"),t.data,{type:"application/octet-stream"}),!status)throw status})).catch((function(e){404===e.response.status?l["a"].create({message:"Template Not Found",color:"negative",textColor:"white",position:"top-right"}):console.log(e.response)}))},createTemplate:function(){var e=this;this.cleanErrors(),this.currentTemplate.name||(this.errors.name="Name required"),this.currentTemplate.file||(this.errors.file="File required"),this.errors.name||this.errors.file||c["a"].createTemplate(this.currentTemplate).then((function(){e.getTemplates(),e.$refs.createModal.hide(),l["a"].create({message:"Template created successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){l["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},updateTemplate:function(){var e=this;this.cleanErrors(),this.currentTemplate.name||(this.errors.name="Name required"),this.errors.name||c["a"].updateTemplate(this.templateId,this.currentTemplate).then((function(){e.getTemplates(),e.$refs.editModal.hide(),l["a"].create({message:"Template updated successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){l["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},deleteTemplate:function(e){var t=this;c["a"].deleteTemplate(e).then((function(e){t.getTemplates(),l["a"].create({message:e.data.datas,color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){l["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},confirmDeleteTemplate:function(e){var t=this;n["a"].create({title:"Confirm Suppression",message:"Template «".concat(e.name,"» will be permanently deleted"),ok:{label:"Confirm",color:"negative"},cancel:{label:"Cancel",color:"white"}}).onOk((function(){return t.deleteTemplate(e._id)}))},clone:function(e){this.cleanCurrentTemplate(),this.currentTemplate.name=e.name,this.templateId=e._id},cleanErrors:function(){this.errors.name="",this.errors.file=""},cleanCurrentTemplate:function(){this.cleanErrors(),this.currentTemplate={name:"",file:"",ext:""},this.templateId=""},handleFile:function(e){var t=this,a=e[0],r=new FileReader;r.onloadend=function(e){t.currentTemplate.file=r.result.split(",")[1]},this.currentTemplate.ext=a.name.split(".").pop(),r.readAsDataURL(a)},dblClick:function(e,t){this.UserService.isAllowed("templates:update")&&(this.clone(t),this.$refs.editModal.show())}}},u=m,f=a("2877"),h=Object(f["a"])(u,r,o,!1,null,null,null);t["default"]=h.exports}}]);