(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"345a":function(i,t,e){"use strict";e.r(t);var n=function(){var i=this,t=i.$createElement,e=i._self._c||t;return e("div",[e("breadcrumb",{attrs:{buttons:"",title:i.$parent.audit.name}},[e("div",{attrs:{slot:"buttons"},slot:"buttons"},[e("q-btn",{staticClass:"q-mr-sm",attrs:{color:"orange",label:"Propose Creation / Update in Vulnerability Database","no-caps":""},on:{click:function(t){return i.backupFinding()}}}),e("q-btn",{staticClass:"q-mr-sm",attrs:{color:"negative",label:"Delete","no-caps":""},on:{click:function(t){return i.deleteFinding()}}}),e("q-btn",{attrs:{color:"positive",label:"Save (ctrl+s)","no-caps":""},on:{click:function(t){return i.updateFinding()}}})],1)]),e("div",{staticClass:"row q-col-gutter-md q-pt-md"},[e("q-tabs",{staticClass:"bg-white full-width",attrs:{align:"left","indicator-color":"primary"},model:{value:i.selectedTab,callback:function(t){i.selectedTab=t},expression:"selectedTab"}},[e("q-tab",{attrs:{name:"definition",default:"",label:"Definition"}}),e("q-tab",{attrs:{name:"proofs",label:"Proofs"}}),e("q-tab",{attrs:{name:"details",label:"Details"}}),e("q-separator",{attrs:{vertical:""}}),e("q-toggle",{attrs:{label:"Completed","true-value":0,"false-value":1,"checked-icon":"check","unchecked-icon":"clear",color:"green"},model:{value:i.finding.status,callback:function(t){i.$set(i.finding,"status",t)},expression:"finding.status"}}),e("q-space")],1),e("q-tab-panels",{staticClass:"bg-transparent col-md-8 col-12 offset-md-2",attrs:{animated:""},on:{"before-transition":i.syncEditors,transition:i.updateOrig},model:{value:i.selectedTab,callback:function(t){i.selectedTab=t},expression:"selectedTab"}},[e("q-tab-panel",{attrs:{name:"definition"}},[e("q-card",{staticClass:"bg-grey-1"},[e("q-card-section",{staticClass:"row q-col-gutter-md"},[e("q-input",{staticClass:"col-md-8 col-12",attrs:{label:"Title *","stack-label":"",outlined:"","bg-color":"white"},model:{value:i.finding.title,callback:function(t){i.$set(i.finding,"title",t)},expression:"finding.title"}}),e("q-select",{staticClass:"col-md-4 col-12",attrs:{label:"Type",options:i.vulnTypesLang,"option-value":"name","option-label":"name","emit-value":"","map-options":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:i.finding.vulnType,callback:function(t){i.$set(i.finding,"vulnType",t)},expression:"finding.vulnType"}}),e("q-field",{staticClass:"col-md-12",attrs:{borderless:"",label:"Description","stack-label":""},scopedSlots:i._u([{key:"default",fn:function(t){return[e("basic-editor",{ref:"basiceditor_description",attrs:{noSync:""},model:{value:i.finding.description,callback:function(t){i.$set(i.finding,"description",t)},expression:"finding.description"}})]}}])}),e("q-field",{staticClass:"col-md-12",attrs:{borderless:"",label:"Observation","stack-label":""},scopedSlots:i._u([{key:"default",fn:function(t){return[e("basic-editor",{ref:"basiceditor_observation",attrs:{noSync:""},model:{value:i.finding.observation,callback:function(t){i.$set(i.finding,"observation",t)},expression:"finding.observation"}})]}}])}),e("textarea-array",{staticClass:"col-12",attrs:{label:"References (One per line)"},model:{value:i.finding.references,callback:function(t){i.$set(i.finding,"references",t)},expression:"finding.references"}})],1),i.finding.customFields&&i.finding.customFields.length>0?e("q-expansion-item",{attrs:{label:"Custom Fields","default-opened":"","header-class":"bg-blue-grey-5 text-white","expand-icon-class":"text-white"}},[e("custom-fields",{ref:"customfields",attrs:{"custom-element":"QCardSection","no-sync-editor":""},model:{value:i.finding.customFields,callback:function(t){i.$set(i.finding,"customFields",t)},expression:"finding.customFields"}})],1):i._e()],1)],1),e("q-tab-panel",{attrs:{name:"proofs"}},[e("div",{staticClass:"q-col-gutter-md row"},[e("div",{staticClass:"col-12"},[e("q-card",{staticClass:"affix-relative-element bg-grey-1"},[e("q-card-section",[e("basic-editor",{ref:"basiceditor_poc",attrs:{noSync:"",affix:""},model:{value:i.finding.poc,callback:function(t){i.$set(i.finding,"poc",t)},expression:"finding.poc"}})],1)],1)],1)])]),e("q-tab-panel",{attrs:{name:"details"}},[e("q-card",{staticClass:"bg-grey-1"},[e("q-card-section",[i._v("Affected Assets")]),e("q-separator"),e("q-card-section",[e("q-field",{attrs:{borderless:""},scopedSlots:i._u([{key:"default",fn:function(t){return[e("basic-editor",{attrs:{toolbar:["format","marks","list"]},model:{value:i.finding.scope,callback:function(t){i.$set(i.finding,"scope",t)},expression:"finding.scope"}})]}}])})],1)],1),e("q-card",{staticClass:"q-mt-md bg-grey-1"},[e("div",{staticClass:"col-12"},[e("cvss-calculator",{attrs:{cvssString:i.finding.cvssv3,cvssScore:i.finding.cvssScore,cvssSeverity:i.finding.cvssSeverity},on:{cvssChange:function(t){i.finding.cvssv3=t},cvssScoreChange:function(t){i.finding.cvssScore=t},cvssSeverityChange:function(t){i.finding.cvssSeverity=t}}})],1)]),e("q-card-section",[e("div",{staticClass:"col-md-12"},[e("risk-calculator",{attrs:{riskProbability:i.finding.riskProbability,riskImpact:i.finding.riskImpact}})],1)]),e("q-card",{staticClass:"q-mt-md bg-grey-1"},[e("q-card-section",[i._v("Course of actions")]),e("q-separator"),e("q-card-section",[e("div",{staticClass:"q-col-gutter-md row"},[e("q-select",{staticClass:"col-md-6 col-12",attrs:{label:"Remediation Difficulty","stack-label":"",options:[{label:"Easy",value:1},{label:"Medium",value:2},{label:"Complex",value:3}],"map-options":"","emit-value":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:i.finding.remediationComplexity,callback:function(t){i.$set(i.finding,"remediationComplexity",t)},expression:"finding.remediationComplexity"}}),e("q-select",{staticClass:"col-md-6 col-12",attrs:{label:"Priority","stack-label":"",options:[{label:"Low",value:1},{label:"Medium",value:2},{label:"High",value:3},{label:"Urgent",value:4}],"map-options":"","emit-value":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:i.finding.priority,callback:function(t){i.$set(i.finding,"priority",t)},expression:"finding.priority"}})],1)]),e("q-card-section",[e("q-field",{staticClass:"col-md-12",attrs:{borderless:"",label:"Remediation","stack-label":""},scopedSlots:i._u([{key:"default",fn:function(t){return[e("basic-editor",{ref:"basiceditor_remediation",attrs:{noSync:""},model:{value:i.finding.remediation,callback:function(t){i.$set(i.finding,"remediation",t)},expression:"finding.remediation"}})]}}])})],1)],1)],1)],1)],1)],1)},s=[],a=(e("4de4"),e("b680"),e("ac1f"),e("466d"),e("159b"),e("99af"),e("c740"),e("a4d3"),e("e01a"),e("2a19")),o=e("436b"),r=e("a897"),d=e("b3a4"),c=e("4b40"),l=e("5d6b"),f=e("78af"),g=e("81ab"),u=e("99ec"),p=e("ed8e"),h=e("1938"),m=e("6fbe"),b={data:function(){return{finding:{},findingOrig:{},selectedTab:"definition",proofsTabVisited:!1,detailsTabVisited:!1,vulnTypes:[],customFields:[]}},components:{BasicEditor:r["a"],Breadcrumb:d["a"],CvssCalculator:c["a"],RiskCalculator:l["a"],TextareaArray:f["a"],CustomFields:g["a"]},mounted:function(){this.auditId=this.$route.params.auditId,this.findingId=this.$route.params.findingId,this.getFinding(),this.getVulnTypes(),this.$socket.emit("menu",{menu:"editFinding",finding:this.findingId,room:this.auditId}),document.addEventListener("keydown",this._listener,!1)},destroyed:function(){document.removeEventListener("keydown",this._listener,!1)},beforeRouteLeave:function(i,t,e){m["a"].syncEditors(this.$refs),this.unsavedChanges()?o["a"].create({title:"There are unsaved changes !",message:"Do you really want to leave ?",ok:{label:"Confirm",color:"negative"},cancel:{label:"Cancel",color:"white"}}).onOk((function(){return e()})):e()},beforeRouteUpdate:function(i,t,e){m["a"].syncEditors(this.$refs),this.unsavedChanges()?o["a"].create({title:"There are unsaved changes !",message:"Do you really want to leave ?",ok:{label:"Confirm",color:"negative"},cancel:{label:"Cancel",color:"white"}}).onOk((function(){return e()})):e()},computed:{vulnTypesLang:function(){var i=this;return this.vulnTypes.filter((function(t){return t.locale===i.$parent.audit.language}))},screenshotsSize:function(){return(JSON.stringify(this.uploadedImages).length/1024).toFixed(2)}},methods:{_listener:function(i){(window.navigator.platform.match("Mac")?i.metaKey:i.ctrlKey)&&83==i.keyCode&&(i.preventDefault(),this.updateFinding())},getVulnTypes:function(){var i=this;p["a"].getVulnerabilityTypes().then((function(t){i.vulnTypes=t.data.datas})).catch((function(i){console.log(i)}))},getFinding:function(){var i=this;p["a"].getCustomFields().then((function(t){return i.customFields=t.data.datas,u["a"].getFinding(i.auditId,i.findingId)})).then((function(t){i.finding=t.data.datas,i.finding.paragraphs.length>0&&!i.finding.poc&&(i.finding.poc=i.convertParagraphsToHTML(i.finding.paragraphs)),i.finding.customFields=m["a"].filterCustomFields("finding",i.finding.category,i.customFields,i.finding.customFields),i.$nextTick((function(){m["a"].syncEditors(i.$refs),i.findingOrig=i.$_.cloneDeep(i.finding)}))})).catch((function(t){t.response?403===t.response.status?i.$router.push({name:"403",params:{error:t.response.data.datas}}):404===t.response.status&&i.$router.push({name:"404",params:{error:t.response.data.datas}}):console.log(t)}))},convertParagraphsToHTML:function(i){var t="";return i.forEach((function(i){t+="<p>".concat(i.text,"</p>"),i.images.length>0&&i.images.forEach((function(i){t+='<img src="'.concat(i.image,'" alt="').concat(i.caption,'" />')}))})),t},updateFinding:function(){var i=this;m["a"].syncEditors(this.$refs),this.$nextTick((function(){i.$refs.customfields&&i.$refs.customfields.requiredFieldsEmpty()?a["a"].create({message:"Please fill all required Fields",color:"negative",textColor:"white",position:"top-right"}):u["a"].updateFinding(i.auditId,i.findingId,i.finding).then((function(){i.findingOrig=i.$_.cloneDeep(i.finding),a["a"].create({message:"Finding updated successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(i){a["a"].create({message:i.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))}))},deleteFinding:function(){var i=this;o["a"].create({title:"Delete current Finding ?",message:"This action can't be cancelled",ok:{label:"Confirm",color:"negative"},cancel:{label:"Cancel",color:"white"}}).onOk((function(){u["a"].deleteFinding(i.auditId,i.findingId).then((function(){a["a"].create({message:"Finding deleted successfully",color:"positive",textColor:"white",position:"top-right"}),i.findingOrig=i.finding;var t=i.$parent.audit.findings.findIndex((function(t){return t._id===i.findingId}));1===i.$parent.audit.findings.length?i.$router.push("/audits/".concat(i.$parent.auditId,"/findings/add")):t===i.$parent.audit.findings.length-1?i.$router.push("/audits/".concat(i.$parent.auditId,"/findings/").concat(i.$parent.audit.findings[t-1]._id)):i.$router.push("/audits/".concat(i.$parent.auditId,"/findings/").concat(i.$parent.audit.findings[t+1]._id))})).catch((function(i){a["a"].create({message:i.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))}))},backupFinding:function(){m["a"].syncEditors(this.$refs),h["a"].backupFinding(this.$parent.audit.language,this.finding).then((function(i){a["a"].create({message:i.data.datas,color:"positive",textColor:"white",position:"top-right"})})).catch((function(i){a["a"].create({message:i.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},syncEditors:function(){m["a"].syncEditors(this.$refs)},updateOrig:function(){"proofs"!==this.selectedTab||this.proofsTabVisited?"details"!==this.selectedTab||this.detailsTabVisited||(m["a"].syncEditors(this.$refs),this.findingOrig.remediation=this.finding.remediation,this.detailsTabVisited=!0):(m["a"].syncEditors(this.$refs),this.findingOrig.poc=this.finding.poc,this.proofsTabVisited=!0)},unsavedChanges:function(){return this.finding.title!==this.findingOrig.title||(!(!this.finding.vulnType&&!this.findingOrig.vulnType||this.finding.vulnType===this.findingOrig.vulnType)||(!(!this.finding.description&&!this.findingOrig.description||this.finding.description===this.findingOrig.description)||(!(!this.finding.observation&&!this.findingOrig.observation||this.finding.observation===this.findingOrig.observation)||(!this.$_.isEqual(this.finding.references,this.findingOrig.references)||(!this.$_.isEqual(this.finding.customFields,this.findingOrig.customFields)||(!(!this.finding.poc&&!this.findingOrig.poc||this.finding.poc===this.findingOrig.poc)||(!(!this.finding.scope&&!this.findingOrig.scope||this.finding.scope===this.findingOrig.scope)||(!(!this.finding.cvssv3&&!this.findingOrig.cvssv3||this.finding.cvssv3===this.findingOrig.cvssv3)||(!(!this.finding.remediationComplexity&&!this.findingOrig.remediationComplexity||this.finding.remediationComplexity===this.findingOrig.remediationComplexity)||(!(!this.finding.priority&&!this.findingOrig.priority||this.finding.priority===this.findingOrig.priority)||(!(!this.finding.remediation&&!this.findingOrig.remediation||this.finding.remediation===this.findingOrig.remediation)||this.finding.status!==this.findingOrig.status)))))))))))}}},v=b,y=(e("931e"),e("2877")),C=Object(y["a"])(v,n,s,!1,null,null,null);t["default"]=C.exports},"931e":function(i,t,e){"use strict";e("a648")},a648:function(i,t,e){}}]);