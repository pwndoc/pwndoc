(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{4959:function(t,e,i){},b232:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("q-drawer",{attrs:{side:"left",value:!0,width:400}},[i("q-splitter",{staticStyle:{height:"100%"},attrs:{horizontal:"",limits:[50,80]},scopedSlots:t._u([{key:"before",fn:function(){return[i("q-list",{staticClass:"home-drawer"},[i("q-item",[i("q-item-section",[t._v("Sections")]),i("q-item-section",{attrs:{side:""}},[i("q-btn",{attrs:{flat:"",dense:"",size:"sm",color:"info",icon:"fa fa-download"},on:{click:t.generateReport}},[i("q-tooltip",{attrs:{anchor:"bottom middle",self:"center left",delay:500,"content-class":"text-bold"}},[t._v("Download Report")])],1)],1)],1),i("q-separator"),i("q-item",{staticClass:"q-py-lg",attrs:{to:"/audits/"+t.auditId+"/general"}},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{name:"fa fa-cog"}})],1),i("q-item-section",[t._v("General Information")])],1),i("div",{staticClass:"row"},t._l(t.generalUsers,(function(t,e){return i("div",{key:e,staticClass:"col multi-colors-bar",style:{background:t.color}})})),0),i("q-separator"),i("q-item",{staticClass:"q-py-lg",attrs:{to:"/audits/"+t.auditId+"/network"}},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{name:"fa fa-globe"}})],1),i("q-item-section",[t._v("Network Scan")])],1),i("div",{staticClass:"row"},t._l(t.networkUsers,(function(t,e){return i("div",{key:e,staticClass:"col multi-colors-bar",style:{background:t.color}})})),0),i("q-separator"),i("q-item",{staticClass:"q-py-lg"},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{name:"fa fa-list"}})],1),i("q-item-section",[t._v("Findings ("+t._s(t.audit.findings.length||0)+")")]),i("q-item-section",{attrs:{avatar:""}},[i("q-btn",{attrs:{icon:"add",round:"",dense:"",color:"secondary"},on:{click:function(e){t.$router.push("/audits/"+t.auditId+"/findings/add").catch((function(t){}))}}})],1)],1),t._l(t.findingList,(function(e){return i("div",{key:e.category},[i("q-item-label",{attrs:{header:""}},[t._v(t._s(e.category))]),t._l(e.findings,(function(e){return i("q-list",{key:e._id,attrs:{"no-border":""}},[i("q-item",{staticClass:"cursor-pointer",attrs:{dense:"",to:"/audits/"+t.auditId+"/findings/"+e._id}},[i("q-item-section",{attrs:{side:""}},[i("q-chip",{staticClass:"text-white",attrs:{size:"sm",square:"",color:t.getFindingColor(e)}},[t._v(t._s(e.cvssSeverity?e.cvssSeverity.substring(0,1):"N"))])],1),i("q-item-section",[i("span",[t._v(t._s(e.title))])]),0===e.status?i("q-item-section",{attrs:{side:""}},[i("q-icon",{attrs:{name:"check",color:"green"}})],1):t._e()],1),i("div",{staticClass:"row"},t._l(t.findingUsers,(function(n,s){return n.finding===e._id?i("div",{key:s,staticClass:"col multi-colors-bar",style:{background:n.color}}):t._e()})),0)],1)}))],2)})),i("q-separator",{staticClass:"q-mt-lg"}),i("q-item",{staticClass:"q-py-lg"},[i("q-item-section",[t._v("Custom Sections")]),i("q-item-section",{attrs:{avatar:""}},[i("q-btn",{attrs:{round:"",dense:"",icon:"add",color:"secondary"}},[0===t.sections.length?i("q-menu",{attrs:{anchor:"top right",self:"top left"}},[i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}]},[i("q-item-section",[t._v("No custom sections defined yet")])],1)],1):i("q-menu",{attrs:{anchor:"top right",self:"top left"}},[i("q-list",{attrs:{separator:""}},t._l(t.sections,(function(e){return i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:e.field,attrs:{clickable:""},on:{click:function(i){return t.createSection(e)}}},[i("q-item-section",[t._v(t._s(e.name))])],1)})),1)],1)],1)],1)],1),t._l(t.audit.sections,(function(e){return i("q-list",{key:e._id},[i("q-item",{attrs:{to:"/audits/"+t.auditId+"/sections/"+e._id}},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{name:t.getSectionIcon(e)}})],1),i("q-item-section",[i("span",[t._v(t._s(e.name))])])],1),i("div",{staticClass:"row"},t._l(t.sectionUsers,(function(n,s){return n.section===e._id?i("div",{key:s,staticClass:"col multi-colors-bar",style:{background:n.color}}):t._e()})),0),i("q-separator")],1)}))],2)]},proxy:!0},{key:"after",fn:function(){return[i("q-list",[i("q-separator"),i("q-item",{staticClass:"q-py-lg"},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{name:"fa fa-user"}})],1),i("q-item-section",[t._v("Users Connected")])],1),i("q-list",{attrs:{dense:""}},t._l(t.users,(function(e){return i("q-item",{key:e._id},[i("q-item-section",{attrs:{side:""}},[i("q-chip",{style:{"background-color":e.color},attrs:{square:"",size:"sm"}})],1),i("q-item-section",[e.me?i("span",[t._v(t._s(e.username)+" (me)")]):i("span",[t._v(t._s(e.username))])])],1)})),1)],1)]},proxy:!0}]),model:{value:t.splitterRatio,callback:function(e){t.splitterRatio=e},expression:"splitterRatio"}})],1),i("router-view",{key:t.$route.fullPath})],1)},s=[],r=i("c973"),a=i.n(r),o=(i("96cf"),i("4de4"),i("d81d"),i("a434"),i("7db0"),i("d3b7"),i("e6cf"),i("e260"),i("3ca3"),i("ddb0"),i("2b3d"),i("ac1f"),i("1276"),i("2a19")),c=i("99ec"),u=i("93d6"),d=i("ed8e"),l={data:function(){return{auditId:"",findings:[],users:[],audit:{findings:{}},sections:[],splitterRatio:80,loading:!0,vulnCategories:[]}},created:function(){this.auditId=this.$route.params.auditId,this.getAudit()},destroyed:function(){this.loading||(this.$socket.emit("leave",{username:u["a"].user.username,room:this.auditId}),this.$socket.off())},computed:{generalUsers:function(){return this.users.filter((function(t){return"general"===t.menu}))},networkUsers:function(){return this.users.filter((function(t){return"network"===t.menu}))},findingUsers:function(){return this.users.filter((function(t){return"editFinding"===t.menu}))},sectionUsers:function(){return this.users.filter((function(t){return"editSection"===t.menu}))},findingList:function(){return _.chain(this.audit.findings).groupBy("category").map((function(t,e){return"undefined"===e?{category:"No Category",findings:t}:{category:e,findings:t}})).value()}},methods:{getFindingColor:function(t){if(t.cvssSeverity&&"None"!==t.cvssSeverity){if("Low"===t.cvssSeverity)return"green";if("Medium"===t.cvssSeverity)return"orange";if("High"===t.cvssSeverity)return"red";if("Critical"===t.cvssSeverity)return"black"}else if(t.priority){if(1===t.priority)return"green";if(2===t.priority)return"orange";if(3===t.priority)return"red";if(4===t.priority)return"black"}return"light-blue"},handleSocket:function(){var t=this;this.$socket.emit("join",{username:u["a"].user.username,room:this.auditId}),this.$socket.on("roomUsers",(function(e){var i=0;t.users=e.map((function(t,e){return t.username===u["a"].user.username&&(t.color="#77C84E",t.me=!0,i=e),t})),t.users.unshift(t.users.splice(i,1)[0])})),this.$socket.on("updateUsers",(function(){t.$socket.emit("updateUsers",{room:t.auditId})})),this.$socket.on("updateAudit",(function(){t.getAudit()}))},getAudit:function(){var t=this;c["a"].getAudit(this.auditId).then((function(e){t.audit=e.data.datas,t.getSections(),t.loading&&t.handleSocket(),t.loading=!1})).catch((function(e){403===e.response.status?t.$router.push({name:"403",params:{error:e.response.data.datas}}):404===e.response.status&&t.$router.push({name:"404",params:{error:e.response.data.datas}})}))},getSections:function(){var t=this;d["a"].getSectionsByLanguage(this.audit.language).then((function(e){t.sections=e.data.datas})).catch((function(t){console.log(t)}))},getSectionIcon:function(t){t=this.sections.find((function(e){return e.field===t.field}));return t&&t.icon||"notes"},createSection:function(t){c["a"].createSection(this.auditId,t).catch((function(t){o["a"].create({message:t.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},BlobReader:function(t){var e=new FileReader;return new Promise((function(i,n){e.onerror=function(){e.abort(),n(new Error("Problem parsing blob"))},e.onload=function(){i(e.result)},e.readAsText(t)}))},generateReport:function(){var t=this;c["a"].generateAuditReport(this.auditId).then((function(t){var e=new Blob([t.data],{type:"application/octet-stream"}),i=document.createElement("a");i.href=window.URL.createObjectURL(e),i.download=t.headers["content-disposition"].split('"')[1],document.body.appendChild(i),i.click(),i.remove()})).catch(function(){var e=a()(regeneratorRuntime.mark((function e(i){var n,s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n="Error generating template",!i.response||!i.response.data){e.next=7;break}return s=new Blob([i.response.data],{type:"application/json"}),e.next=5,t.BlobReader(s);case 5:r=e.sent,n=JSON.parse(r).datas;case 7:o["a"].create({message:n,type:"negative",textColor:"white",position:"top",closeBtn:!0,timeout:0,classes:"text-pre-wrap"});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}},f=l,m=(i("ea54"),i("2877")),p=i("9404"),g=i("8562"),h=i("1c1c"),v=i("66e5"),q=i("4074"),y=i("9c40"),b=i("05c0"),k=i("eb85"),w=i("0016"),C=i("0170"),S=i("b047"),I=i("4e73"),R=i("7f67"),U=i("eebe"),x=i.n(U),$=Object(m["a"])(f,n,s,!1,null,null,null);e["default"]=$.exports;x()($,"components",{QDrawer:p["a"],QSplitter:g["a"],QList:h["a"],QItem:v["a"],QItemSection:q["a"],QBtn:y["a"],QTooltip:b["a"],QSeparator:k["a"],QIcon:w["a"],QItemLabel:C["a"],QChip:S["a"],QMenu:I["a"]}),x()($,"directives",{ClosePopup:R["a"]})},ea54:function(t,e,i){"use strict";i("4959")}}]);