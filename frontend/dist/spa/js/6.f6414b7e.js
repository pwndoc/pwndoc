(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{"3af2":function(e,t,a){},b4a3:function(e,t,a){"use strict";a("3af2")},f85a:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-tabs",{staticClass:"bg-white full-width",attrs:{"no-caps":"",align:"left","indicator-color":"primary","active-bg-color":"grey-3"},model:{value:e.selectedTab,callback:function(t){e.selectedTab=t},expression:"selectedTab"}},[a("q-tab",{attrs:{name:"languages",default:"",label:"Languages"}}),a("q-tab",{attrs:{name:"audit-types",label:"Audit Types"}}),a("q-tab",{attrs:{name:"vulnerability-types",label:"Vulnerability Types"}}),a("q-tab",{attrs:{name:"vulnerability-categories",label:"Vulnerability Categories"}}),a("q-tab",{attrs:{name:"custom-fields",label:"Custom Fields"}}),a("q-tab",{attrs:{name:"custom-sections",label:"Custom Sections"}})],1),a("div",{staticClass:"row"},[a("q-tab-panels",{staticClass:"bg-transparent col-md-10 col-12 offset-md-1 q-mt-md",on:{"before-transition":function(t){return e.Utils.syncEditors(e.$refs)}},model:{value:e.selectedTab,callback:function(t){e.selectedTab=t},expression:"selectedTab"}},[a("q-tab-panel",{attrs:{name:"languages"}},[a("q-card",{staticClass:"bg-grey-1"},[a("q-card-section",[a("div",{staticClass:"text-grey-8"},[e._v("\n              Languages used in Audits and Vulnerabilities\n            ")])]),a("q-card-section",{staticClass:"row"},[e.UserService.isAllowed("languages:create")?a("div",{staticClass:"col-md-6 col-12"},[a("q-item",[a("q-item-section",[a("q-input",{attrs:{label:"Language",clearable:"",error:!!e.errors.language,"error-message":e.errors.language,outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createLanguage(t)}},model:{value:e.newLanguage.language,callback:function(t){e.$set(e.newLanguage,"language",t)},expression:"newLanguage.language"}})],1),a("q-item-section",[a("q-input",{attrs:{label:"Locale",clearable:"",error:!!e.errors.locale,"error-message":e.errors.locale,outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createLanguage(t)}},model:{value:e.newLanguage.locale,callback:function(t){e.$set(e.newLanguage,"locale",t)},expression:"newLanguage.locale"}})],1),a("q-item-section",{attrs:{side:""}},[a("q-btn",{attrs:{color:"secondary",unelevated:"",label:"+",size:"md"},on:{click:e.createLanguage}})],1)],1)],1):e._e(),e.editLanguage?a("div",{staticClass:"col-md-6 col-12"},[a("q-card",{staticClass:"bg-grey-1",attrs:{flat:"",bordered:""}},[a("q-toolbar",[a("div",{staticClass:"text-grey-8"},[e._v("Edit Languages")])]),a("q-separator"),a("q-card-section",[a("draggable",{attrs:{handle:".handle","ghost-class":"drag-ghost"},model:{value:e.editLanguages,callback:function(t){e.editLanguages=t},expression:"editLanguages"}},e._l(e.editLanguages,(function(t,i){return a("q-item",{key:i},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{staticClass:"cursor-pointer handle",attrs:{name:"mdi-arrow-split-horizontal",color:"grey"}})],1),a("q-item-section",[a("q-input",{attrs:{label:"Language",outlined:"","bg-color":"white"},model:{value:t.language,callback:function(a){e.$set(t,"language",a)},expression:"language.language"}})],1),a("q-item-section",[a("q-input",{attrs:{label:"Locale",outlined:"","bg-color":"white"},model:{value:t.locale,callback:function(a){e.$set(t,"locale",a)},expression:"language.locale"}})],1),a("q-item-section",{attrs:{side:""}},[a("q-btn",{staticClass:"q-mt-md",attrs:{color:"red",unelevated:"",label:"x",size:"md"},on:{click:function(a){return e.removeLanguage(t.locale)}}})],1)],1)})),1)],1),a("q-card-actions",{staticClass:"q-mr-lg",attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",outline:""},on:{click:function(t){e.editLanguage=!1}}},[e._v("Cancel")]),a("q-btn",{attrs:{color:"secondary",unelevated:""},on:{click:e.updateLanguages}},[e._v("Save")])],1)],1)],1):a("div",{staticClass:"col-md-6 col-12"},[e.languages.length>0?a("q-card",{staticClass:"bg-grey-1",attrs:{flat:"",bordered:""}},[a("q-toolbar",[a("div",{staticClass:"text-grey-8"},[e._v("List of Languages")]),a("q-space"),e.UserService.isAllowed("languages:update")?a("q-btn",{attrs:{flat:"",color:"primary",icon:"fa fa-edit"},on:{click:function(t){e.editLanguage=!0,e.editLanguages=e.$_.cloneDeep(e.languages)}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"center left",delay:500,"content-class":"text-bold"}},[e._v("Edit")])],1):e._e()],1),a("q-separator"),a("q-card-section",e._l(e.languages,(function(t){return a("q-item",{key:t.locale},[a("q-item-section",[a("q-input",{attrs:{label:"Language",readonly:"",outlined:"","bg-color":"white"},model:{value:t.language,callback:function(a){e.$set(t,"language",a)},expression:"language.language"}})],1),a("q-item-section",[a("q-input",{attrs:{label:"Locale",readonly:"",outlined:"","bg-color":"white"},model:{value:t.locale,callback:function(a){e.$set(t,"locale",a)},expression:"language.locale"}})],1)],1)})),1)],1):e._e()],1)])],1)],1),a("q-tab-panel",{attrs:{name:"audit-types"}},[a("q-card",{staticClass:"bg-grey-1"},[a("q-card-section",[a("div",{staticClass:"text-grey-8"},[e._v("Audit types used in Audits")])]),e.languages.length>0?a("q-card-section",{staticClass:"row"},[e.UserService.isAllowed("audit-types:create")?a("div",{staticClass:"col-md-6 col-12"},[a("q-item",{staticClass:"row"},[a("q-item-section",{staticClass:"col-md-4 col-12"},[a("q-select",{attrs:{label:"Language",options:e.languages,"option-value":"locale","option-label":"language","emit-value":"","map-options":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.newAuditType.locale,callback:function(t){e.$set(e.newAuditType,"locale",t)},expression:"newAuditType.locale"}})],1)],1),a("q-item",[a("q-item-section",[a("q-input",{attrs:{label:"Name",clearable:"",error:!!e.errors.auditType,"error-message":e.errors.auditType,outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createAuditType(t)}},model:{value:e.newAuditType.name,callback:function(t){e.$set(e.newAuditType,"name",t)},expression:"newAuditType.name"}})],1),a("q-item-section",{attrs:{side:""}},[a("q-btn",{attrs:{color:"secondary",unelevated:"",label:"+",size:"md"},on:{click:e.createAuditType}})],1)],1)],1):e._e(),e.editAuditType?a("div",{staticClass:"col-md-6 col-12"},[a("q-card",{staticClass:"bg-grey-1",attrs:{flat:"",bordered:""}},[a("q-toolbar",[a("div",{staticClass:"text-grey-8"},[e._v("Edit Audit Types")])]),a("q-separator"),a("q-card-section",[a("draggable",{attrs:{handle:".handle","ghost-class":"drag-ghost"},model:{value:e.editAuditTypes,callback:function(t){e.editAuditTypes=t},expression:"editAuditTypes"}},e._l(e.editAuditTypes,(function(t,i){return t.locale===e.newAuditType.locale?a("q-item",{key:i},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{staticClass:"cursor-pointer handle",attrs:{name:"mdi-arrow-split-horizontal",color:"grey"}})],1),a("q-item-section",[a("q-input",{attrs:{label:"Name",outlined:"","bg-color":"white"},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"auditType.name"}})],1),a("q-item-section",{attrs:{side:""}},[a("q-btn",{staticClass:"q-mt-md",attrs:{color:"red",unelevated:"",label:"x",size:"md"},on:{click:function(a){return e.removeAuditType(t)}}})],1)],1):e._e()})),1)],1),a("q-card-actions",{staticClass:"q-mr-lg",attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",outline:""},on:{click:function(t){e.editAuditType=!1}}},[e._v("Cancel")]),a("q-btn",{attrs:{color:"secondary",unelevated:""},on:{click:e.updateAuditTypes}},[e._v("Save")])],1)],1)],1):a("div",{staticClass:"col-md-6 col-12"},[e.auditTypes.length>0?a("q-card",{staticClass:"bg-grey-1",attrs:{flat:"",bordered:""}},[a("q-toolbar",[a("div",{staticClass:"text-grey-8"},[e._v("List of Audit Types")]),a("q-space"),e.UserService.isAllowed("audit-types:update")?a("q-btn",{attrs:{flat:"",color:"primary",icon:"fa fa-edit"},on:{click:function(t){e.editAuditType=!0,e.editAuditTypes=e.$_.cloneDeep(e.auditTypes)}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"center left",delay:500,"content-class":"text-bold"}},[e._v("Edit")])],1):e._e()],1),a("q-separator"),e._l(e.auditTypes,(function(t){return t.locale===e.newAuditType.locale?a("q-item",{key:t.name},[a("q-item-section",[a("q-input",{attrs:{label:"Name",readonly:"",outlined:"","bg-color":"white"},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"auditType.name"}})],1)],1):e._e()}))],2):e._e()],1)]):a("q-card-section",[a("p",[e._v("Please create at least one Language")])])],1)],1),a("q-tab-panel",{attrs:{name:"vulnerability-types"}},[a("q-card",{staticClass:"bg-grey-1"},[a("q-card-section",[a("div",{staticClass:"text-grey-8"},[e._v("\n              Create Vulnerability types used in Vulnerabilities and Findings\n            ")])]),e.languages.length>0?a("q-card-section",{staticClass:"row"},[e.UserService.isAllowed("vulnerability-types:create")?a("div",{staticClass:"col-md-6 col-12"},[a("q-item",{staticClass:"row"},[a("q-item-section",{staticClass:"col-md-4 col-12"},[a("q-select",{attrs:{label:"Language",options:e.languages,"option-value":"locale","option-label":"language","emit-value":"","map-options":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.newVulnType.locale,callback:function(t){e.$set(e.newVulnType,"locale",t)},expression:"newVulnType.locale"}})],1)],1),a("q-item",[a("q-item-section",[a("q-input",{attrs:{label:"Name",clearable:"",error:!!e.errors.vulnType,"error-message":e.errors.vulnType,outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createVulnerabilityType(t)}},model:{value:e.newVulnType.name,callback:function(t){e.$set(e.newVulnType,"name",t)},expression:"newVulnType.name"}})],1),a("q-item-section",{attrs:{side:""}},[a("q-btn",{attrs:{color:"secondary",unelevated:"",label:"+",size:"md"},on:{click:e.createVulnerabilityType}})],1)],1)],1):e._e(),e.editVulnType?a("div",{staticClass:"col-md-6 col-12"},[a("q-card",{staticClass:"bg-grey-1",attrs:{flat:"",bordered:""}},[a("q-toolbar",[a("div",{staticClass:"text-grey-8"},[e._v("Edit Vulnerability Types")])]),a("q-separator"),a("q-card-section",[a("draggable",{attrs:{handle:".handle","ghost-class":"drag-ghost"},model:{value:e.editVulnTypes,callback:function(t){e.editVulnTypes=t},expression:"editVulnTypes"}},e._l(e.editVulnTypes,(function(t,i){return t.locale===e.newVulnType.locale?a("q-item",{key:i},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{staticClass:"cursor-pointer handle",attrs:{name:"mdi-arrow-split-horizontal",color:"grey"}})],1),a("q-item-section",[a("q-input",{attrs:{label:"Name",outlined:"","bg-color":"white"},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"vulnType.name"}})],1),a("q-item-section",{attrs:{side:""}},[a("q-btn",{staticClass:"q-mt-md",attrs:{color:"red",unelevated:"",label:"x",size:"md"},on:{click:function(a){return e.removeVulnType(t)}}})],1)],1):e._e()})),1)],1),a("q-card-actions",{staticClass:"q-mr-lg",attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",outline:""},on:{click:function(t){e.editVulnType=!1}}},[e._v("Cancel")]),a("q-btn",{attrs:{color:"secondary",unelevated:""},on:{click:e.updateVulnTypes}},[e._v("Save")])],1)],1)],1):a("div",{staticClass:"col-md-6 col-12"},[e.vulnTypes.length>0?a("q-card",{staticClass:"bg-grey-1",attrs:{flat:"",bordered:""}},[a("q-toolbar",[a("div",{staticClass:"text-grey-8"},[e._v("List of Vulnerability Types")]),a("q-space"),e.UserService.isAllowed("vulnerability-types:update")?a("q-btn",{attrs:{flat:"",color:"primary",icon:"fa fa-edit"},on:{click:function(t){e.editVulnType=!0,e.editVulnTypes=e.$_.cloneDeep(e.vulnTypes)}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"center left",delay:500,"content-class":"text-bold"}},[e._v("Edit")])],1):e._e()],1),a("q-separator"),e._l(e.vulnTypes,(function(t){return t.locale===e.newVulnType.locale?a("q-item",{key:t.name},[a("q-item-section",[a("q-input",{attrs:{label:"Name",readonly:"",outlined:"","bg-color":"white"},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"vulnType.name"}})],1)],1):e._e()}))],2):e._e()],1)]):a("q-card-section",[a("p",[e._v("Please create at least one Language")])])],1)],1),a("q-tab-panel",{attrs:{name:"vulnerability-categories"}},[a("q-card",{staticClass:"bg-grey-1"},[a("q-card-section",[a("div",{staticClass:"text-grey-8"},[e._v("\n              Create Vulnerability categories used in Vulnerabilities and\n              Findings\n            ")])]),a("q-card-section",{staticClass:"row"},[e.UserService.isAllowed("vulnerability-categories:create")?a("div",{staticClass:"col-md-6 col-12"},[a("q-item",[a("q-item-section",[a("q-input",{attrs:{label:"Name",clearable:"",error:!!e.errors.vulnCat,"error-message":e.errors.vulnCat,outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createVulnerabilityCategory(t)}},model:{value:e.newVulnCat.name,callback:function(t){e.$set(e.newVulnCat,"name",t)},expression:"newVulnCat.name"}})],1),a("q-item-section",{attrs:{side:""}},[a("q-btn",{attrs:{color:"secondary",unelevated:"",label:"+",size:"md"},on:{click:e.createVulnerabilityCategory}})],1)],1),a("q-item",[a("q-field",{staticClass:"col-12",attrs:{borderless:"",label:"Description","stack-label":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("basic-editor",{ref:"basiceditor_newsection",model:{value:e.newVulnCat.description,callback:function(t){e.$set(e.newVulnCat,"description",t)},expression:"newVulnCat.description"}})]}}],null,!1,4293414037)})],1)],1):e._e(),e.editCategory?a("div",{staticClass:"col-md-6 col-12"},[a("q-card",{staticClass:"bg-grey-1",attrs:{flat:"",bordered:""}},[a("q-toolbar",[a("div",{staticClass:"text-grey-8"},[e._v("Edit Categories")])]),a("q-separator"),a("q-card-section",[a("draggable",{attrs:{handle:".handle","ghost-class":"drag-ghost"},model:{value:e.editCategories,callback:function(t){e.editCategories=t},expression:"editCategories"}},e._l(e.editCategories,(function(t,i){return a("div",{key:i},[a("q-item",[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{staticClass:"cursor-pointer handle",attrs:{name:"mdi-arrow-split-horizontal",color:"grey"}})],1),a("q-item-section",[a("q-input",{attrs:{label:"Name",outlined:"","bg-color":"white"},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"vulnCat.name"}})],1),a("q-item-section",{attrs:{side:""}},[a("q-btn",{attrs:{color:"red",unelevated:"",label:"x",size:"md"},on:{click:function(a){return e.removeCategory(t)}}})],1)],1),a("q-item",[a("q-field",{staticClass:"col-12",attrs:{borderless:"",label:"Description","stack-label":""},scopedSlots:e._u([{key:"default",fn:function(i){return[a("basic-editor",{ref:"basiceditor_newsection",refInFor:!0,model:{value:t.description,callback:function(a){e.$set(t,"description",a)},expression:"vulnCat.description"}})]}}],null,!0)})],1),e.idx!==e.editCategories.length-1?a("q-separator",{attrs:{size:"2px",color:"blue-grey-5"}}):e._e()],1)})),0)],1),a("q-card-actions",{staticClass:"q-mr-lg",attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",outline:""},on:{click:function(t){e.editCategory=!1}}},[e._v("Cancel")]),a("q-btn",{attrs:{color:"secondary",unelevated:""},on:{click:e.updateVulnCategories}},[e._v("Save")])],1)],1)],1):a("div",{staticClass:"col-md-6 col-12"},[e.vulnCategories.length>0?a("q-card",{staticClass:"bg-grey-1",attrs:{flat:"",bordered:""}},[a("q-toolbar",[a("div",{staticClass:"text-grey-8"},[e._v("List of Categories")]),a("q-space"),e.UserService.isAllowed("vulnerability-categories:update")?a("q-btn",{attrs:{flat:"",color:"primary",icon:"fa fa-edit"},on:{click:function(t){e.editCategory=!0,e.editCategories=e.$_.cloneDeep(e.vulnCategories)}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"center left",delay:500,"content-class":"text-bold"}},[e._v("Edit")])],1):e._e()],1),a("q-separator"),e._l(e.vulnCategories,(function(t){return a("div",{key:t._id},[a("q-item",[a("q-item-section",[a("q-input",{attrs:{label:"Name",readonly:"",outlined:"","bg-color":"white"},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"vulnCat.name"}})],1)],1),a("q-item",[a("q-field",{staticClass:"col-md-12",attrs:{borderless:"",label:"Description","stack-label":""},scopedSlots:e._u([{key:"default",fn:function(i){return[a("basic-editor",{attrs:{editable:!1},model:{value:t.description,callback:function(a){e.$set(t,"description",a)},expression:"vulnCat.description"}})]}}],null,!0)})],1),t._id!==e.vulnCategories.length-1?a("q-separator",{attrs:{size:"2px",color:"blue-grey-5"}}):e._e()],1)}))],2):e._e()],1)])],1)],1),a("q-tab-panel",{attrs:{name:"custom-fields"}},[a("q-card",{staticClass:"bg-grey-1"},[a("q-card-section",[a("div",{staticClass:"text-grey-8"},[e._v("\n              Create and manage Custom Fields for different Views\n            ")])]),a("q-card-section",[a("q-item",[a("q-item-section",[a("q-select",{attrs:{label:"Select View",options:e.cfDisplayOptions,"emit-value":"","map-options":"",outlined:"","bg-color":"white"},on:{input:function(t){e.newCustomField.displaySub=""}},model:{value:e.newCustomField.display,callback:function(t){e.$set(e.newCustomField,"display",t)},expression:"newCustomField.display"}})],1),a("q-item-section",[["finding","vulnerability"].includes(e.newCustomField.display)?a("q-select",{attrs:{label:"Select Category",options:e.vulnCategories,"option-value":"name","option-label":"name","options-sanitize":"","emit-value":"","map-options":"","stack-label":"",clearable:"",outlined:"","bg-color":"white"},model:{value:e.newCustomField.displaySub,callback:function(t){e.$set(e.newCustomField,"displaySub",t)},expression:"newCustomField.displaySub"}}):e._e()],1)],1),e.UserService.isAllowed("custom-fields:create")?a("q-item",[a("q-item-section",{staticClass:"col-md-2"},[a("q-select",{ref:"select-component",attrs:{label:"Select Component",options:e.cfComponentOptions,"emit-value":"","map-options":"",rules:[function(e){return!!e||"Field is required"}],"lazy-rules":"ondemand","hide-bottom-space":"",outlined:"","bg-color":"white"},model:{value:e.newCustomField.fieldType,callback:function(t){e.$set(e.newCustomField,"fieldType",t)},expression:"newCustomField.fieldType"}})],1),"space"!==e.newCustomField.fieldType?a("q-item-section",[a("q-input",{ref:"input-label",attrs:{label:"Label",clearable:"",rules:[function(e){return!!e||"Field is required"}],"lazy-rules":"ondemand","hide-bottom-space":"",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createCustomField(t)}},model:{value:e.newCustomField.label,callback:function(t){e.$set(e.newCustomField,"label",t)},expression:"newCustomField.label"}})],1):e._e(),"space"!==e.newCustomField.fieldType?a("q-item-section",[a("q-input",{attrs:{label:"Description",clearable:"",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createCustomField(t)}},model:{value:e.newCustomField.description,callback:function(t){e.$set(e.newCustomField,"description",t)},expression:"newCustomField.description"}})],1):e._e(),a("q-item-section",{staticClass:"col-md-1"},[a("q-select",{attrs:{label:"Size",options:[1,2,3,4,5,6,7,8,9,10,11,12],outlined:"","bg-color":"white"},model:{value:e.newCustomField.size,callback:function(t){e.$set(e.newCustomField,"size",t)},expression:"newCustomField.size"}})],1),a("q-item-section",{staticClass:"col-md-1"},[a("q-select",{attrs:{label:"Offset",options:[0,1,2,3,4,5,6,7,8,9,10,11,12],outlined:"","bg-color":"white"},model:{value:e.newCustomField.offset,callback:function(t){e.$set(e.newCustomField,"offset",t)},expression:"newCustomField.offset"}})],1),"space"!==e.newCustomField.fieldType?a("q-item-section",{staticClass:"col-md-1"},[a("q-toggle",{attrs:{label:"Required","left-label":""},model:{value:e.newCustomField.required,callback:function(t){e.$set(e.newCustomField,"required",t)},expression:"newCustomField.required"}})],1):e._e()],1):e._e()],1),e.UserService.isAllowed("custom-fields:create")?a("q-card-section",[a("q-btn",{staticClass:"q-ml-md",staticStyle:{width:"100px"},attrs:{color:"secondary",unelevated:"","no-caps":"",label:"Add"},on:{click:e.createCustomField}})],1):e._e()],1),e.canDisplayCustomFields()?a("q-card",{staticClass:"q-mt-md bg-grey-1"},[a("q-card-section",[a("draggable",{staticClass:"row",attrs:{group:"cfields",handle:".handle","ghost-class":"drag-ghost",direction:"horizontal"},model:{value:e.customFields,callback:function(t){e.customFields=t},expression:"customFields"}},e._l(e.customFields,(function(t,i){return e.canDisplayCustomField(t)?a("q-item",{key:i,class:"col-md-"+(t.size||12)+" col-12 offset-md-"+(t.offset||0)},[e.UserService.isAllowed("custom-fields:update")?a("q-item-section",{attrs:{avatar:""}},[a("q-btn",{staticClass:"handle",attrs:{flat:"",color:"grey",icon:"mdi-arrow-split-horizontal",dense:"",size:"sm"}}),a("q-btn",{attrs:{flat:"",color:"primary",icon:"mdi-pencil",dense:"",size:"sm"}},[a("q-menu",{attrs:{"content-style":"width: 300px",anchor:"top left",self:"top end","content-class":"bg-grey-1"}},["space"!==t.fieldType?a("q-item",[a("q-item-section",[a("q-input",{attrs:{label:"Label",clearable:"",outlined:"","bg-color":"white"},model:{value:t.label,callback:function(a){e.$set(t,"label",a)},expression:"field.label"}})],1)],1):e._e(),"space"!==t.fieldType?a("q-item",[a("q-item-section",[a("q-input",{attrs:{label:"Description",clearable:"",outlined:"","bg-color":"white"},on:{clear:function(e){t.description=""}},model:{value:t.description,callback:function(a){e.$set(t,"description",a)},expression:"field.description"}})],1)],1):e._e(),a("q-item",[a("q-item-section",[a("q-select",{attrs:{label:"Size",options:[1,2,3,4,5,6,7,8,9,10,11,12],outlined:"","bg-color":"white"},model:{value:t.size,callback:function(a){e.$set(t,"size",a)},expression:"field.size"}})],1),a("q-item-section",[a("q-select",{attrs:{label:"Offset",options:[0,1,2,3,4,5,6,7,8,9,10,11,12],outlined:"","bg-color":"white"},model:{value:t.offset,callback:function(a){e.$set(t,"offset",a)},expression:"field.offset"}})],1)],1),"space"!==t.fieldType?a("q-item",[a("q-item-section",[a("q-toggle",{attrs:{label:"Required",outlined:"","bg-color":"white"},model:{value:t.required,callback:function(a){e.$set(t,"required",a)},expression:"field.required"}})],1)],1):e._e()],1)],1),a("q-btn",{attrs:{flat:"",color:"red",icon:"mdi-delete",dense:"",size:"sm"},on:{click:function(a){return e.deleteCustomField(t)}}})],1):e._e(),a("q-item-section",["text"===t.fieldType?a("q-field",{attrs:{"label-slot":"","stack-label":"",borderless:"",hint:t.description,"hide-bottom-space":""},scopedSlots:e._u([{key:"control",fn:function(){return[a("basic-editor",{ref:"basiceditor_custom",refInFor:!0,model:{value:t.text,callback:function(a){e.$set(t,"text",a)},expression:"field.text"}})]},proxy:!0},{key:"label",fn:function(){return[e._v("\n                      "+e._s(t.label)+"\n                      "),t.required?a("span",{staticClass:"text-red"},[e._v("*")]):e._e()]},proxy:!0}],null,!0)}):e._e(),"input"===t.fieldType?a("q-input",{attrs:{label:t.label,"stack-label":"",hint:t.description,"hide-bottom-space":"",outlined:"","bg-color":"white"},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                      "+e._s(t.label)+"\n                      "),t.required?a("span",{staticClass:"text-red"},[e._v("*")]):e._e()]},proxy:!0}],null,!0),model:{value:t.text,callback:function(a){e.$set(t,"text",a)},expression:"field.text"}}):e._e()],1)],1):e._e()})),1)],1),e.UserService.isAllowed("custom-fields:update")?a("q-card-section",[a("q-btn",{staticClass:"q-ml-md",staticStyle:{width:"100px"},attrs:{label:"Save",color:"secondary",unelevated:"","no-caps":""},on:{click:e.updateCustomFields}})],1):e._e()],1):e._e()],1),a("q-tab-panel",{attrs:{name:"custom-sections"}},[a("q-card",{staticClass:"bg-grey-1"},[a("q-card-section",[a("div",{staticClass:"text-grey-8"},[e._v("Create Custom Sections used in Audits")])]),e.languages.length>0?a("q-card-section",{staticClass:"row"},[e.UserService.isAllowed("sections:create")?a("div",{staticClass:"col-md-6 col-12"},[a("q-item",{staticClass:"row"},[a("q-item-section",{staticClass:"col-md-2"},[a("q-select",{attrs:{label:"Language",options:e.languages,"option-value":"locale","option-label":"language","emit-value":"","map-options":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.newSection.locale,callback:function(t){e.$set(e.newSection,"locale",t)},expression:"newSection.locale"}})],1)],1),a("q-item",[a("q-item-section",[a("q-input",{attrs:{label:"Name",clearable:"",error:!!e.errors.sectionName,"error-message":e.errors.sectionName,"hide-bottom-space":"",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createSection(t)}},model:{value:e.newSection.name,callback:function(t){e.$set(e.newSection,"name",t)},expression:"newSection.name"}})],1),a("q-item-section",[a("q-input",{attrs:{label:"Field (For Template)",clearable:"",error:!!e.errors.sectionField,"error-message":e.errors.sectionField,"hide-bottom-space":"",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createSection(t)}},model:{value:e.newSection.field,callback:function(t){e.$set(e.newSection,"field",t)},expression:"newSection.field"}})],1),a("q-item-section",[a("q-input",{attrs:{label:"Icon (Material/Font Awesome)",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createSection(t)}},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-avatar",[a("q-icon",{attrs:{size:"sm",name:e.newSection.icon}})],1)]},proxy:!0}],null,!1,4009882848),model:{value:e.newSection.icon,callback:function(t){e.$set(e.newSection,"icon",t)},expression:"newSection.icon"}})],1),a("q-item-section",{attrs:{side:""}},[a("q-btn",{attrs:{color:"secondary",unelevated:"",label:"+",size:"md"},on:{click:e.createSection}})],1)],1),a("q-item",[a("q-field",{staticClass:"col-12",attrs:{borderless:"",label:"Default Text","stack-label":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("basic-editor",{ref:"basiceditor_newsection",attrs:{noSync:""},model:{value:e.newSection.text,callback:function(t){e.$set(e.newSection,"text",t)},expression:"newSection.text"}})]}}],null,!1,210494428)})],1)],1):e._e(),e.editSection?a("div",{staticClass:"col-md-6"},[a("q-card",{staticClass:"bg-grey-1",attrs:{flat:"",bordered:""}},[a("q-toolbar",[a("div",{staticClass:"text-grey-8"},[e._v("Edit Sections")])]),a("q-separator"),a("q-card-section",[a("draggable",{attrs:{handle:".handle","ghost-class":"drag-ghost",direction:"horizontal"},model:{value:e.editSections,callback:function(t){e.editSections=t},expression:"editSections"}},e._l(e.editSections,(function(t,i){return t.locale===e.newSection.locale?a("div",{key:i},[a("q-item",[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{staticClass:"cursor-pointer handle",attrs:{name:"mdi-arrow-split-horizontal",color:"grey"}})],1),a("q-item-section",[a("q-input",{attrs:{label:"Name",outlined:"","bg-color":"white"},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"section.name"}})],1),a("q-item-section",[a("q-input",{attrs:{label:"Field",outlined:"","bg-color":"white"},model:{value:t.field,callback:function(a){e.$set(t,"field",a)},expression:"section.field"}})],1),a("q-item-section",[a("q-input",{attrs:{label:"Icon (Material/Font Awesome)","stack-label":"",outlined:"","bg-color":"white"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-avatar",[a("q-icon",{attrs:{size:"sm",name:t.icon}})],1)]},proxy:!0}],null,!0),model:{value:t.icon,callback:function(a){e.$set(t,"icon",a)},expression:"section.icon"}})],1),a("q-item-section",{attrs:{side:""}},[a("q-btn",{staticClass:"q-mt-md",attrs:{color:"red",unelevated:"",label:"x",size:"md"},on:{click:function(t){return e.removeSection(i)}}})],1)],1),a("q-item",[a("q-field",{staticClass:"col-md-12",attrs:{borderless:"",label:"Default Text","stack-label":""},scopedSlots:e._u([{key:"default",fn:function(i){return[a("basic-editor",{ref:"basiceditor_updatesection",refInFor:!0,attrs:{noSync:"",disableDrop:""},model:{value:t.text,callback:function(a){e.$set(t,"text",a)},expression:"section.text"}})]}}],null,!0)})],1),i!==e.editSections.length-1?a("q-separator",{attrs:{size:"2px",color:"blue-grey-5"}}):e._e()],1):e._e()})),0)],1),a("q-card-actions",{staticClass:"q-mr-lg",attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",outline:""},on:{click:function(t){e.editSection=!1}}},[e._v("Cancel")]),a("q-btn",{attrs:{color:"secondary",unelevated:""},on:{click:e.updateSections}},[e._v("Save")])],1)],1)],1):a("div",{staticClass:"col-md-6"},[e.sections.length>0?a("q-card",{staticClass:"bg-grey-1",attrs:{flat:"",bordered:""}},[a("q-toolbar",[a("div",{staticClass:"text-grey-8"},[e._v("List of Sections")]),a("q-space"),e.UserService.isAllowed("sections:update")?a("q-btn",{attrs:{flat:"",color:"primary",icon:"fa fa-edit"},on:{click:function(t){e.editSection=!0,e.editSections=e.$_.cloneDeep(e.sections)}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"center left",delay:500,"content-class":"text-bold"}},[e._v("Edit")])],1):e._e()],1),a("q-separator"),e._l(e.sections,(function(t,i){return t.locale===e.newSection.locale?a("div",{key:i},[a("q-item",[a("q-item-section",[a("q-input",{attrs:{label:"Name",readonly:"",outlined:"","bg-color":"white"},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"section.name"}})],1),a("q-item-section",[a("q-input",{attrs:{label:"Field",readonly:"",outlined:"","bg-color":"white"},model:{value:t.field,callback:function(a){e.$set(t,"field",a)},expression:"section.field"}})],1),a("q-item-section",[a("q-input",{attrs:{label:"Icon (Material/Font Awesome)","stack-label":"",readonly:"",outlined:"","bg-color":"white"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-avatar",[a("q-icon",{attrs:{size:"sm",name:t.icon}})],1)]},proxy:!0}],null,!0),model:{value:t.icon,callback:function(a){e.$set(t,"icon",a)},expression:"section.icon"}})],1)],1),a("q-item",[a("q-field",{staticClass:"col-md-12",attrs:{borderless:"",label:"Default Text","stack-label":""},scopedSlots:e._u([{key:"default",fn:function(i){return[a("basic-editor",{attrs:{editable:!1},model:{value:t.text,callback:function(a){e.$set(t,"text",a)},expression:"section.text"}})]}}],null,!0)})],1),i!==e.sections.length-1?a("q-separator",{attrs:{size:"2px",color:"blue-grey-5"}}):e._e()],1):e._e()}))],2):e._e()],1)]):a("q-card-section",[a("p",[e._v("Please create at least one Language")])])],1)],1)],1)],1)],1)},s=[],n=(a("4de4"),a("b0c0"),a("a4d3"),a("e01a"),a("159b"),a("99af"),a("ac1f"),a("5319"),a("a434"),a("436b")),l=a("2a19"),o=a("b76a"),r=a.n(o),c=a("a897"),d=a("81ab"),u=a("ed8e"),p=a("6fbe"),g=a("93d6"),m={data:function(){return{UserService:g["a"],Utils:p["a"],languages:[],newLanguage:{locale:"",language:""},editLanguages:[],editLanguage:!1,auditTypes:[],newAuditType:{name:"",locale:""},editAuditTypes:[],editAuditType:!1,vulnTypes:[],newVulnType:{name:"",locale:""},editVulnTypes:[],editVulnType:!1,vulnCategories:[],newVulnCat:{name:"",description:""},editCategories:[],editCategory:!1,customFields:[],newCustomField:{label:"",fieldType:"",display:"general",displaySub:"",size:12,offset:0,required:!1,description:""},cfDisplayOptions:[{label:"Audit General",value:"general"},{label:"Audit Finding",value:"finding"},{label:"Vulnerability",value:"vulnerability"}],cfComponentOptions:[{label:"Editor",value:"text"},{label:"Input",value:"input"},{label:"Space",value:"space"}],sections:[],newSection:{field:"",name:"",locale:"",icon:""},editSections:[],editSection:!1,errors:{locale:"",language:"",auditType:"",vulnType:"",vulnCat:"",vulnCatField:"",sectionField:"",sectionName:"",fieldLabel:"",fieldType:""},selectedTab:"languages"}},components:{BasicEditor:c["a"],CustomFields:d["a"],draggable:r.a},mounted:function(){this.getLanguages(),this.getAuditTypes(),this.getVulnerabilityTypes(),this.getVulnerabilityCategories(),this.getSections(),this.getCustomFields()},computed:{filteredCustomFields:function(){var e=this;return this.customFields.filter((function(t){return t.display===e.newCustomField.display&&t.displayList.every((function(t){return e.newCustomField.displayList.indexOf(t)>-1}))}))}},methods:{getLanguages:function(){var e=this;u["a"].getLanguages().then((function(t){e.languages=t.data.datas,e.languages.length>0&&(e.newAuditType.locale=e.languages[0].locale,e.newVulnType.locale=e.languages[0].locale,e.newSection.locale=e.languages[0].locale)})).catch((function(e){console.log(e)}))},createLanguage:function(){var e=this;this.cleanErrors(),this.newLanguage.locale||(this.errors.locale="Locale required"),this.newLanguage.language||(this.errors.language="Language required"),this.errors.locale||this.errors.language||u["a"].createLanguage(this.newLanguage).then((function(t){e.newLanguage.locale="",e.newLanguage.language="",e.getLanguages(),l["a"].create({message:"Language created successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){l["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},updateLanguages:function(){var e=this;u["a"].updateLanguages(this.editLanguages).then((function(t){e.getLanguages(),e.editLanguage=!1,l["a"].create({message:"Languages updated successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){l["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},removeLanguage:function(e){this.editLanguages=this.editLanguages.filter((function(t){return t.locale!==e}))},getAuditTypes:function(){var e=this;u["a"].getAuditTypes().then((function(t){e.auditTypes=t.data.datas})).catch((function(e){console.log(e)}))},createAuditType:function(){var e=this;this.cleanErrors(),this.newAuditType.name||(this.errors.auditType="Name required"),this.errors.auditType||u["a"].createAuditType(this.newAuditType).then((function(t){e.newAuditType.name="",e.getAuditTypes(),l["a"].create({message:"Audit type created successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){l["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},updateAuditTypes:function(){var e=this;u["a"].updateAuditTypes(this.editAuditTypes).then((function(t){e.getAuditTypes(),e.editAuditType=!1,l["a"].create({message:"Audit Types updated successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){l["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},removeAuditType:function(e){this.editAuditTypes=this.editAuditTypes.filter((function(t){return t.name!==e.name||t.locale!==e.locale}))},getVulnerabilityTypes:function(){var e=this;u["a"].getVulnerabilityTypes().then((function(t){e.vulnTypes=t.data.datas})).catch((function(e){console.log(e)}))},createVulnerabilityType:function(){var e=this;this.cleanErrors(),this.newVulnType.name||(this.errors.vulnType="Name required"),this.errors.vulnType||u["a"].createVulnerabilityType(this.newVulnType).then((function(t){e.newVulnType.name="",e.getVulnerabilityTypes(),l["a"].create({message:"Vulnerability type created successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){l["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},updateVulnTypes:function(){var e=this;u["a"].updateVulnTypes(this.editVulnTypes).then((function(t){e.getVulnerabilityTypes(),e.editVulnType=!1,l["a"].create({message:"Vulnerability Types updated successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){l["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},removeVulnType:function(e){this.editVulnTypes=this.editVulnTypes.filter((function(t){return t.name!==e.name||t.locale!==e.locale}))},getVulnerabilityCategories:function(){var e=this;u["a"].getVulnerabilityCategories().then((function(t){e.vulnCategories=t.data.datas})).catch((function(e){console.log(e)}))},createVulnerabilityCategory:function(){var e=this;this.cleanErrors(),this.newVulnCat.name||(this.errors.vulnCat="Name required"),this.errors.vulnCat||u["a"].createVulnerabilityCategory(this.newVulnCat).then((function(t){e.newVulnCat.name="",e.newVulnCat.description="",e.getVulnerabilityCategories(),l["a"].create({message:"Vulnerability category created successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){l["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},updateVulnCategories:function(){var e=this;u["a"].updateVulnerabilityCategories(this.editCategories).then((function(t){e.getVulnerabilityCategories(),e.editCategory=!1,l["a"].create({message:"Vulnerability Categories updated successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){l["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},removeCategory:function(e){this.editCategories=this.editCategories.filter((function(t){return t.name!==e.name}))},getCustomFields:function(){var e=this;u["a"].getCustomFields().then((function(t){e.customFields=t.data.datas.filter((function(e){return e.display}))})).catch((function(e){console.log(e)}))},createCustomField:function(){var e=this;"space"!==this.newCustomField.fieldType&&(this.$refs["select-component"].validate(),this.$refs["input-label"].validate(),this.$refs["select-component"].hasError||this.$refs["input-label"].hasError)||(this.newCustomField.position=this.customFields.length,u["a"].createCustomField(this.newCustomField).then((function(t){e.newCustomField.label="",e.getCustomFields(),l["a"].create({message:"Custom Field created successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){l["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})})))},updateCustomFields:function(){var e=this,t=0;this.customFields.forEach((function(e){return e.position=t++})),u["a"].updateCustomFields(this.customFields).then((function(t){e.getCustomFields(),l["a"].create({message:"Custom Fields updated successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){l["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},deleteCustomField:function(e){var t=this;n["a"].create({title:"Confirm Suppression",message:'\n                <div class="row">\n                    <div class="col-md-2">\n                        <i class="material-icons text-warning" style="font-size:42px">warning</i>\n                    </div>\n                    <div class="col-md-10">\n                        Custom Field <strong>'.concat(e.label,"</strong> will be permanently deleted.<br>\n                        This field will be removed from <strong>ALL</strong> Vulnerablities and associated data\n                        will be permanently <strong>LOST</strong>!\n                    </div>\n                </div>\n                "),ok:{label:"Confirm",color:"negative"},cancel:{label:"Cancel",color:"white"},html:!0,style:"width: 600px"}).onOk((function(){u["a"].deleteCustomField(e._id).then((function(a){t.getCustomFields(),l["a"].create({message:"\n                        Custom Field <strong>".concat(e.label,"</strong> deleted successfully.<br>\n                        <strong>").concat(a.data.datas.vulnCount,"</strong> Vulnerabilities were affected."),color:"positive",textColor:"white",position:"top-right",html:!0})})).catch((function(e){console.log(e),l["a"].create({message:e.response.data.datas.msg||e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))}))},canDisplayCustomField:function(e){return(this.newCustomField.display===e.display||"finding"===this.newCustomField.display&&"vulnerability"===e.display)&&(this.newCustomField.displaySub===e.displaySub||""===e.displaySub)},canDisplayCustomFields:function(){var e=this;return this.customFields.some((function(t){return e.canDisplayCustomField(t)}))},getSections:function(){var e=this;u["a"].getSections().then((function(t){e.sections=t.data.datas})).catch((function(e){console.log(e)}))},createSection:function(){var e=this;this.cleanErrors(),this.newSection.field||(this.errors.sectionField="Field required"),this.newSection.name||(this.errors.sectionName="Name required"),this.errors.sectionName||this.errors.sectionField||(p["a"].syncEditors(this.$refs),this.newSection.text&&(this.newSection.text=this.newSection.text.replace(/(<p><\/p>)+$/,"")),u["a"].createSection(this.newSection).then((function(t){e.newSection.field="",e.newSection.name="",e.newSection.text="",e.newSection.icon="",e.getSections(),l["a"].create({message:"Section created successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){l["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})})))},updateSections:function(){var e=this;p["a"].syncEditors(this.$refs),u["a"].updateSections(this.editSections).then((function(t){e.sections=e.editSections,e.editSection=!1,l["a"].create({message:"Sections updated successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){l["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},removeSection:function(e){this.editSections.splice(e,1)},cleanErrors:function(){this.errors.locale="",this.errors.language="",this.errors.auditType="",this.errors.vulnType="",this.errors.vulnCat="",this.errors.fieldLabel="",this.errors.fieldType="",this.errors.sectionField="",this.errors.sectionName=""}}},b=m,y=(a("b4a3"),a("2877")),f=Object(y["a"])(b,i,s,!1,null,null,null);t["default"]=f.exports}}]);