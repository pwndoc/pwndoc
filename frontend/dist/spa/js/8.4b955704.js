(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{3641:function(e,t,i){},4628:function(e,t,i){"use strict";i("3641")},a964:function(e,t,i){"use strict";i.r(t);var l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"row"},[0===e.languages.length?i("div",{staticClass:"col-md-4 offset-md-4 q-mt-md"},[e._m(0)]):i("div",{staticClass:"col-md-8 col-12 offset-md-2 q-mt-md"},[i("q-table",{staticClass:"sticky-header-table",attrs:{"card-class":"bg-grey-1","table-header-class":"bg-grey-1",columns:e.dtHeaders,data:e.computedVulnerabilities,filter:e.search,"filter-method":e.customFilter,pagination:e.pagination,"sort-method":e.customSort,separator:"none","row-key":"_id",loading:e.loading},on:{"update:pagination":function(t){e.pagination=t},"row-dblclick":e.dblClick},scopedSlots:e._u([{key:"top",fn:function(){return[i("q-select",{staticClass:"col-md-2",attrs:{label:"Language",options:e.languages,"option-value":"locale","option-label":"language","map-options":"","emit-value":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.dtLanguage,callback:function(t){e.dtLanguage=t},expression:"dtLanguage"}}),i("q-toggle",{attrs:{label:"Valid","true-value":0},model:{value:e.search.valid,callback:function(t){e.$set(e.search,"valid",t)},expression:"search.valid"}}),i("q-toggle",{attrs:{label:"New",color:"light-blue","true-value":1},model:{value:e.search.new,callback:function(t){e.$set(e.search,"new",t)},expression:"search.new"}}),i("q-toggle",{attrs:{label:"Updates",color:"orange","true-value":2},model:{value:e.search.updates,callback:function(t){e.$set(e.search,"updates",t)},expression:"search.updates"}}),e.UserService.isAllowed("vulnerabilities:update")?i("q-btn",{staticClass:"q-ml-md",attrs:{label:"Merge Vulnerabilities",outline:"",color:"secondary","no-caps":""},on:{click:function(t){return e.$refs.mergeModal.show()}}}):e._e(),i("q-space"),e.UserService.isAllowed("vulnerabilities:create")?i("q-btn-dropdown",{attrs:{unelevated:"",color:"secondary","no-caps":"",label:"New Vulnerability"}},[i("q-list",{attrs:{separator:""}},[i("q-item-label",{attrs:{header:""}},[e._v("Select category")]),i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){e.currentCategory=null,e.cleanCurrentVulnerability(),e.$refs.createModal.show()}}},[i("q-item-section",[i("q-item-label",[e._v("No Category")])],1)],1),e._l(e.vulnCategories,(function(t){return i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:t.name,attrs:{clickable:""},on:{click:function(i){e.currentCategory=e.$_.cloneDeep(t),e.cleanCurrentVulnerability(),e.$refs.createModal.show()}}},[i("q-item-section",[i("q-item-label",[e._v(e._s(t.name))])],1)],1)}))],2)],1):e._e()]},proxy:!0},{key:"top-row",fn:function(t){return[i("q-tr",[i("q-td",{staticStyle:{width:"60%"}},[i("q-input",{attrs:{dense:"",color:"secondary",label:"Search...",clearable:"",autofocus:"",outlined:"","bg-color":"white"},model:{value:e.search.title,callback:function(t){e.$set(e.search,"title",t)},expression:"search.title"}})],1),i("q-td",{staticStyle:{width:"20%"}},[i("q-select",{attrs:{dense:"",color:"secondary",label:"Search...",clearable:"",options:e.vulnCategoriesOptions,"options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.search.category,callback:function(t){e.$set(e.search,"category",t)},expression:"search.category"}})],1),i("q-td",{staticStyle:{width:"20%"}},[i("q-select",{attrs:{dense:"",color:"secondary",label:"Search...",clearable:"",options:e.vulnTypeOptions,"options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.search.type,callback:function(t){e.$set(e.search,"type",t)},expression:"search.type"}})],1),i("q-td")],1)]}},{key:"body",fn:function(t){return["Not defined for this language yet"!==e.getDtTitle(t.row)?i("q-tr",{class:1===t.row.status?"bg-light-blue-2":2===t.row.status?"bg-orange-2":"",attrs:{props:t},on:{dblclick:function(i){return e.dblClick(t.row)}}},[i("q-td",{key:"title",attrs:{props:t}},[e._v("\n                        "+e._s(e.getDtTitle(t.row))+"\n                    ")]),i("q-td",{key:"category",attrs:{props:t}},[e._v("\n                        "+e._s(t.row.category||"No Category")+"\n                    ")]),i("q-td",{key:"type",attrs:{props:t}},[e._v("\n                        "+e._s(e.getDtType(t.row))+"\n                    ")]),i("q-td",{key:"action",staticStyle:{width:"1px"},attrs:{props:t}},[e.UserService.isAllowed("vulnerabilities:update")?i("q-btn",{attrs:{size:"sm",flat:"",color:"primary",icon:"fa fa-edit"},on:{click:function(i){e.clone(t.row),2===t.row.status?e.$refs.updatesModal.show():e.$refs.editModal.show()}}},[i("q-tooltip",{attrs:{anchor:"bottom middle",self:"center left",delay:500,"content-class":"text-bold"}},[e._v("Edit")])],1):i("q-btn",{attrs:{size:"sm",flat:"",color:"primary",icon:"fa fa-eye"},on:{click:function(i){e.clone(t.row),e.$refs.editModal.show()}}},[i("q-tooltip",{attrs:{anchor:"bottom middle",self:"center left",delay:500,"content-class":"text-bold"}},[e._v("View")])],1),i("q-btn",{attrs:{size:"sm",flat:"",color:"secondary",icon:"fa fa-fingerprint"},on:{click:function(i){return e.goToAudits(t.row)}}},[i("q-tooltip",{attrs:{anchor:"bottom middle",self:"center left",delay:500,"content-class":"text-bold"}},[e._v("Find Audits")])],1),e.UserService.isAllowed("vulnerabilities:delete")?i("q-btn",{attrs:{size:"sm",flat:"",color:"negative",icon:"fa fa-trash"},on:{click:function(i){return e.confirmDeleteVulnerability(t.row)}}},[i("q-tooltip",{attrs:{anchor:"bottom middle",self:"center left",delay:500,"content-class":"text-bold"}},[e._v("Delete")])],1):e._e()],1)],1):e._e()]}},{key:"bottom",fn:function(t){return[1===e.computedVulnerabilities.length?i("span",[e._v(e._s(e.filteredRowsCount)+" / 1 Vulnerability (Total: "+e._s(e.vulnerabilities.length)+")")]):i("span",[e._v(e._s(e.filteredRowsCount)+" / "+e._s(e.computedVulnerabilities.length)+" Vulnerabilities (Total: "+e._s(e.vulnerabilities.length)+")")]),i("q-space"),i("span",[e._v("Results per page:")]),i("q-select",{staticClass:"q-px-md",attrs:{options:e.rowsPerPageOptions,"emit-value":"","map-options":"",dense:"","options-dense":"","options-cover":"",borderless:""},model:{value:e.pagination.rowsPerPage,callback:function(t){e.$set(e.pagination,"rowsPerPage",t)},expression:"pagination.rowsPerPage"}}),i("q-pagination",{attrs:{input:"",max:t.pagesNumber},model:{value:e.pagination.page,callback:function(t){e.$set(e.pagination,"page",t)},expression:"pagination.page"}})]}}])})],1)]),e.languages.length>0?i("q-dialog",{ref:"createModal",attrs:{maximized:"",position:"right",persistent:""},on:{hide:function(t){return e.cleanCurrentVulnerability()}}},[i("q-card",{staticClass:"bg-grey-1",style:e.$q.screen.gt.md?"width: 50vw":""},[i("q-bar",{staticClass:"bg-primary text-white"},[i("div",{staticClass:"q-toolbar-title"},[e.currentCategory?i("span",[e._v("Add Vulnerability ("+e._s(e.currentCategory.name)+")")]):i("span",[e._v("Add Vulnerability (No Category)")])]),i("q-space"),i("q-btn",{attrs:{dense:"",flat:"",icon:"close"},on:{click:function(t){return e.$refs.createModal.hide()}}})],1),i("q-card-section",[i("div",{staticClass:"q-col-gutter-md row"},[i("q-input",{staticClass:"col-md-8",attrs:{label:"Title *","stack-label":"",autofocus:"",error:!!e.errors.title,"error-message":e.errors.title,"hide-bottom-space":"",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createVulnerability()}},model:{value:e.currentVulnerability.details[e.currentDetailsIndex].title,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"title",t)},expression:"currentVulnerability.details[currentDetailsIndex].title"}}),i("q-select",{staticClass:"col-md-2",attrs:{label:"Type",options:e.vulnTypesLang,"option-value":"name","option-label":"name","emit-value":"","map-options":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.currentVulnerability.details[e.currentDetailsIndex].vulnType,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"vulnType",t)},expression:"currentVulnerability.details[currentDetailsIndex].vulnType"}}),i("q-select",{staticClass:"col-md-2",attrs:{label:"Language","stack-label":"",options:e.languages,"option-value":"locale","option-label":"language","map-options":"","emit-value":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.currentLanguage,callback:function(t){e.currentLanguage=t},expression:"currentLanguage"}})],1)]),i("q-card-section",[i("q-field",{attrs:{borderless:"",label:"Description","stack-label":""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("basic-editor",{model:{value:e.currentVulnerability.details[e.currentDetailsIndex].description,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"description",t)},expression:"currentVulnerability.details[currentDetailsIndex].description"}})]}}],null,!1,2660471658)})],1),i("q-card-section",[i("q-field",{attrs:{borderless:"",label:"Observation","stack-label":""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("basic-editor",{model:{value:e.currentVulnerability.details[e.currentDetailsIndex].observation,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"observation",t)},expression:"currentVulnerability.details[currentDetailsIndex].observation"}})]}}],null,!1,1096777518)})],1),i("q-card-section",[i("div",{staticClass:"q-col-gutter-md row"},[i("q-select",{staticClass:"col-md-6",attrs:{label:"Remediation Complexity","stack-label":"",options:[{label:"Easy",value:1},{label:"Medium",value:2},{label:"Complex",value:3}],"map-options":"","emit-value":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.currentVulnerability.remediationComplexity,callback:function(t){e.$set(e.currentVulnerability,"remediationComplexity",t)},expression:"currentVulnerability.remediationComplexity"}}),i("q-select",{staticClass:"col-md-6",attrs:{label:"Remediation Priority","stack-label":"",options:[{label:"Low",value:1},{label:"Medium",value:2},{label:"High",value:3},{label:"Urgent",value:4}],"map-options":"","emit-value":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.currentVulnerability.priority,callback:function(t){e.$set(e.currentVulnerability,"priority",t)},expression:"currentVulnerability.priority"}})],1)]),i("q-card-section",[i("div",{staticClass:"col-md-12"},[i("cvss-calculator",{attrs:{cvssString:e.currentVulnerability.cvssv3,cvssScore:e.currentVulnerability.cvssScore,cvssSeverity:e.currentVulnerability.cvssSeverity},on:{cvssChange:function(t){e.currentVulnerability.cvssv3=t},cvssScoreChange:function(t){e.currentVulnerability.cvssScore=t},cvssSeverityChange:function(t){e.currentVulnerability.cvssSeverity=t}}})],1)]),i("q-card-section",[i("div",{staticClass:"col-md-12"},[i("risk-calculator",{attrs:{riskProbability:e.currentVulnerability.riskProbability,riskImpact:e.currentVulnerability.riskImpact,riskScore:e.currentVulnerability.riskScore,riskSeverity:e.currentVulnerability.riskSeverity},on:{riskProbabilityChange:function(t){e.currentVulnerability.riskProbability=t},riskImpactChange:function(t){e.currentVulnerability.riskImpact=t},riskScoreChange:function(t){e.currentVulnerability.riskScore=t},riskSeverityChange:function(t){e.currentVulnerability.riskSeverity=t}}})],1)]),i("q-card-section",[i("q-field",{attrs:{borderless:"",label:"Remediation","stack-label":""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("basic-editor",{model:{value:e.currentVulnerability.details[e.currentDetailsIndex].remediation,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"remediation",t)},expression:"currentVulnerability.details[currentDetailsIndex].remediation"}})]}}],null,!1,2697923779)})],1),i("q-card-section",[i("div",{staticClass:"q-col-gutter-md row"},[i("q-select",{staticClass:"col-md-6",attrs:{label:"Remediation Complexity","stack-label":"",options:[{label:"Easy",value:1},{label:"Medium",value:2},{label:"Complex",value:3}],"map-options":"","emit-value":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.currentVulnerability.remediationComplexity,callback:function(t){e.$set(e.currentVulnerability,"remediationComplexity",t)},expression:"currentVulnerability.remediationComplexity"}}),i("q-select",{staticClass:"col-md-6",attrs:{label:"Remediation Priority","stack-label":"",options:[{label:"Low",value:1},{label:"Medium",value:2},{label:"High",value:3},{label:"Urgent",value:4}],"map-options":"","emit-value":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.currentVulnerability.priority,callback:function(t){e.$set(e.currentVulnerability,"priority",t)},expression:"currentVulnerability.priority"}})],1)]),i("q-card-section",[i("textarea-array",{attrs:{label:"References (One per line)"},model:{value:e.currentVulnerability.details[e.currentDetailsIndex].references,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"references",t)},expression:"currentVulnerability.details[currentDetailsIndex].references"}})],1),i("q-expansion-item",{attrs:{label:"Custom Fields","default-opened":"","header-class":"bg-blue-grey-5 text-white","expand-icon-class":"text-white"}},[i("custom-fields",{ref:"customfields",attrs:{category:e.currentVulnerability.category,"custom-element":"QCardSection",display:"vuln"},model:{value:e.currentVulnerability.details[e.currentDetailsIndex].customFields,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"customFields",t)},expression:"currentVulnerability.details[currentDetailsIndex].customFields"}})],1),i("q-separator"),i("q-card-actions",{attrs:{align:"right"}},[i("q-btn",{attrs:{color:"primary",outline:""},on:{click:function(t){return e.$refs.createModal.hide()}}},[e._v("Cancel")]),i("q-btn",{attrs:{color:"secondary",unelevated:""},on:{click:function(t){return e.createVulnerability()}}},[e._v("Create")])],1)],1)],1):e._e(),e.languages.length>0?i("q-dialog",{ref:"editModal",attrs:{maximized:"",position:"right",persistent:e.UserService.isAllowed("vulnerabilities:update")},on:{hide:function(t){return e.cleanCurrentVulnerability()}}},[i("q-card",{staticClass:"bg-grey-1",style:e.$q.screen.gt.md?"width: 50vw":""},[i("q-bar",{staticClass:"bg-primary text-white"},[i("div",{staticClass:"q-toolbar-title"},[e.currentVulnerability.category?i("span",[e._v("Edit Vulnerability ("+e._s(e.currentVulnerability.category)+")")]):i("span",[e._v("Edit Vulnerability (No Category)")])]),i("q-separator",{staticClass:"q-mx-md",attrs:{vertical:"",color:"white"}}),i("q-btn-dropdown",{attrs:{label:"Change Category",color:"white"}},[i("q-list",{attrs:{separator:""}},[i("q-item-label",{attrs:{header:""}},[e._v("Select category")]),i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){return e.editChangeCategory()}}},[i("q-item-section",[i("q-item-label",[e._v("No Category")])],1)],1),e._l(e.vulnCategories,(function(t){return i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:t.name,attrs:{clickable:""},on:{click:function(i){return e.editChangeCategory(t)}}},[i("q-item-section",[i("q-item-label",[e._v(e._s(t.name))])],1)],1)}))],2)],1),i("q-space"),i("q-btn",{attrs:{dense:"",flat:"",icon:"close"},on:{click:function(t){return e.$refs.editModal.hide()}}})],1),i("q-card-section",[i("div",{staticClass:"q-col-gutter-md row"},[i("q-input",{staticClass:"col-md-8",attrs:{label:"Title *","stack-label":"",autofocus:"",error:!!e.errors.title,"error-message":e.errors.title,"hide-bottom-space":"",outlined:"","bg-color":"white"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateVulnerability()}},model:{value:e.currentVulnerability.details[e.currentDetailsIndex].title,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"title",t)},expression:"currentVulnerability.details[currentDetailsIndex].title"}}),i("q-select",{staticClass:"col-md-2",attrs:{label:"Type",options:e.vulnTypesLang,"option-value":"name","option-label":"name","emit-value":"","map-options":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.currentVulnerability.details[e.currentDetailsIndex].vulnType,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"vulnType",t)},expression:"currentVulnerability.details[currentDetailsIndex].vulnType"}}),i("q-select",{staticClass:"col-md-2",attrs:{label:"Language","stack-label":"",options:e.languages,"option-value":"locale","option-label":"language","map-options":"","emit-value":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.currentLanguage,callback:function(t){e.currentLanguage=t},expression:"currentLanguage"}})],1)]),i("q-card-section",[i("q-field",{attrs:{borderless:"",label:"Description","stack-label":""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("basic-editor",{model:{value:e.currentVulnerability.details[e.currentDetailsIndex].description,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"description",t)},expression:"currentVulnerability.details[currentDetailsIndex].description"}})]}}],null,!1,2660471658)})],1),i("q-card-section",[i("q-field",{attrs:{borderless:"",label:"Observation","stack-label":""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("basic-editor",{model:{value:e.currentVulnerability.details[e.currentDetailsIndex].observation,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"observation",t)},expression:"currentVulnerability.details[currentDetailsIndex].observation"}})]}}],null,!1,1096777518)})],1),i("q-card-section",[i("div",{staticClass:"col-md-12"},[i("cvss-calculator",{attrs:{cvssString:e.currentVulnerability.cvssv3,cvssScore:e.currentVulnerability.cvssScore,cvssSeverity:e.currentVulnerability.cvssSeverity},on:{cvssChange:function(t){e.currentVulnerability.cvssv3=t},cvssScoreChange:function(t){e.currentVulnerability.cvssScore=t},cvssSeverityChange:function(t){e.currentVulnerability.cvssSeverity=t}}})],1)]),i("q-card-section",[i("div",{staticClass:"col-md-12"},[i("risk-calculator",{attrs:{riskProbability:e.currentVulnerability.riskProbability,riskImpact:e.currentVulnerability.riskImpact,riskScore:e.currentVulnerability.riskScore,riskSeverity:e.currentVulnerability.riskSeverity},on:{riskProbabilityChange:function(t){e.currentVulnerability.riskProbability=t},riskImpactChange:function(t){e.currentVulnerability.riskImpact=t},riskScoreChange:function(t){e.currentVulnerability.riskScore=t},riskSeverityChange:function(t){e.currentVulnerability.riskSeverity=t}}})],1)]),i("q-card-section",[i("q-field",{attrs:{borderless:"",label:"Remediation","stack-label":""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("basic-editor",{model:{value:e.currentVulnerability.details[e.currentDetailsIndex].remediation,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"remediation",t)},expression:"currentVulnerability.details[currentDetailsIndex].remediation"}})]}}],null,!1,2697923779)})],1),i("q-card-section",[i("div",{staticClass:"q-col-gutter-md row"},[i("q-select",{staticClass:"col-md-6",attrs:{label:"Remediation Complexity","stack-label":"",options:[{label:"Easy",value:1},{label:"Medium",value:2},{label:"Complex",value:3}],"map-options":"","emit-value":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.currentVulnerability.remediationComplexity,callback:function(t){e.$set(e.currentVulnerability,"remediationComplexity",t)},expression:"currentVulnerability.remediationComplexity"}}),i("q-select",{staticClass:"col-md-6",attrs:{label:"Remediation Priority","stack-label":"",options:[{label:"Low",value:1},{label:"Medium",value:2},{label:"High",value:3},{label:"Urgent",value:4}],"map-options":"","emit-value":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.currentVulnerability.priority,callback:function(t){e.$set(e.currentVulnerability,"priority",t)},expression:"currentVulnerability.priority"}})],1)]),i("q-card-section",[i("textarea-array",{attrs:{label:"References (One per line)"},model:{value:e.currentVulnerability.details[e.currentDetailsIndex].references,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"references",t)},expression:"currentVulnerability.details[currentDetailsIndex].references"}})],1),i("q-expansion-item",{attrs:{label:"Custom Fields","default-opened":"","header-class":"bg-blue-grey-5 text-white","expand-icon-class":"text-white"}},[i("custom-fields",{ref:"customfields",attrs:{"custom-element":"QCardSection"},model:{value:e.currentVulnerability.details[e.currentDetailsIndex].customFields,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"customFields",t)},expression:"currentVulnerability.details[currentDetailsIndex].customFields"}})],1),i("q-separator"),e.UserService.isAllowed("vulnerabilities:update")?i("q-card-actions",{attrs:{align:"right"}},[i("q-btn",{attrs:{color:"primary",outline:""},on:{click:function(t){return e.$refs.editModal.hide()}}},[e._v("Cancel")]),1===e.currentVulnerability.status?i("q-btn",{attrs:{label:"Approve",color:"light-blue",unelevated:""},on:{click:function(t){return e.updateVulnerability()}}}):i("q-btn",{attrs:{color:"secondary",unelevated:""},on:{click:function(t){return e.updateVulnerability()}}},[e._v("Update")])],1):e._e()],1)],1):e._e(),e.languages.length>0?i("q-dialog",{ref:"updatesModal",attrs:{"full-width":"","full-height":"",persistent:""},on:{hide:function(t){return e.cleanCurrentVulnerability()}}},[i("q-layout",{attrs:{view:"lHh lpr lFf",container:""}},[i("q-header",{attrs:{elevated:""}},[i("q-bar",{staticClass:"bg-primary text-white"},[i("div",{staticClass:"q-toolbar-title"},[e._v("\n                    Update Vulnerability\n                ")]),i("q-space"),i("q-btn",{attrs:{dense:"",flat:"",icon:"close"},on:{click:function(t){return e.$refs.updatesModal.hide()}}})],1)],1),i("q-page-container",[i("q-page",{staticClass:"row"},[i("q-card",{staticClass:"col-md-6"},[i("q-card-section",[i("q-tabs",{staticClass:"bg-blue-grey-2",attrs:{value:"current",dense:"",align:"left","no-caps":"","indicator-color":"primary"}},[i("q-tab",{attrs:{name:"current",label:"Current"}})],1)],1),i("q-card-section",{staticClass:"q-col-gutter-md row q-pt-none"},[i("q-input",{staticClass:"col-md-8",attrs:{label:"Title *","stack-label":"",readonly:"",outlined:"","bg-color":"white"},model:{value:e.currentVulnerability.details[e.currentDetailsIndex].title,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"title",t)},expression:"currentVulnerability.details[currentDetailsIndex].title"}}),i("q-select",{staticClass:"col-md-2",attrs:{label:"Type",options:e.vulnTypesLang,"option-value":"name","option-label":"name","emit-value":"","map-options":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.currentVulnerability.details[e.currentDetailsIndex].vulnType,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"vulnType",t)},expression:"currentVulnerability.details[currentDetailsIndex].vulnType"}}),i("q-select",{staticClass:"col-md-2",attrs:{label:"Language","stack-label":"",options:e.languages,"option-value":"locale","option-label":"language","map-options":"","emit-value":"",readonly:"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.currentLanguage,callback:function(t){e.currentLanguage=t},expression:"currentLanguage"}})],1),i("q-card-section",[i("q-field",{attrs:{borderless:"",label:"Description","stack-label":""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("basic-editor",{model:{value:e.currentVulnerability.details[e.currentDetailsIndex].description,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"description",t)},expression:"currentVulnerability.details[currentDetailsIndex].description"}})]}}],null,!1,2660471658)})],1),i("q-card-section",[i("q-field",{attrs:{borderless:"",label:"Observation","stack-label":""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("basic-editor",{model:{value:e.currentVulnerability.details[e.currentDetailsIndex].observation,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"observation",t)},expression:"currentVulnerability.details[currentDetailsIndex].observation"}})]}}],null,!1,1096777518)})],1),i("q-card-section",[i("cvss-calculator",{attrs:{cvssString:e.currentVulnerability.cvssv3,cvssScore:e.currentVulnerability.cvssScore,cvssSeverity:e.currentVulnerability.cvssSeverity},on:{cvssChange:function(t){e.currentVulnerability.cvssv3=t},cvssScoreChange:function(t){e.currentVulnerability.cvssScore=t},cvssSeverityChange:function(t){e.currentVulnerability.cvssSeverity=t}}})],1),i("q-card-section",[i("div",{staticClass:"col-md-12"},[i("risk-calculator",{attrs:{riskProbability:e.currentVulnerability.riskProbability,riskImpact:e.currentVulnerability.riskImpact,riskScore:e.currentVulnerability.riskScore,riskSeverity:e.currentVulnerability.riskSeverity},on:{riskProbabilityChange:function(t){e.currentVulnerability.riskProbability=t},riskImpactChange:function(t){e.currentVulnerability.riskImpact=t},riskScoreChange:function(t){e.currentVulnerability.riskScore=t},riskSeverityChange:function(t){e.currentVulnerability.riskSeverity=t}}})],1)]),i("q-card-section",[i("q-field",{attrs:{borderless:"",label:"Remediation","stack-label":""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("basic-editor",{model:{value:e.currentVulnerability.details[e.currentDetailsIndex].remediation,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"remediation",t)},expression:"currentVulnerability.details[currentDetailsIndex].remediation"}})]}}],null,!1,2697923779)})],1),i("q-card-section",{staticClass:"q-col-gutter-md row"},[i("q-select",{staticClass:"col-md-6",attrs:{label:"Remediation Complexity","stack-label":"",options:[{label:"Easy",value:1},{label:"Medium",value:2},{label:"Complex",value:3}],"map-options":"","emit-value":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.currentVulnerability.remediationComplexity,callback:function(t){e.$set(e.currentVulnerability,"remediationComplexity",t)},expression:"currentVulnerability.remediationComplexity"}}),i("q-select",{staticClass:"col-md-6",attrs:{label:"Remediation Priority","stack-label":"",options:[{label:"Low",value:1},{label:"Medium",value:2},{label:"High",value:3},{label:"Urgent",value:4}],"map-options":"","emit-value":"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:e.currentVulnerability.priority,callback:function(t){e.$set(e.currentVulnerability,"priority",t)},expression:"currentVulnerability.priority"}})],1),i("q-card-section",[i("textarea-array",{attrs:{label:"References (One per line)"},model:{value:e.currentVulnerability.details[e.currentDetailsIndex].references,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"references",t)},expression:"currentVulnerability.details[currentDetailsIndex].references"}})],1),i("q-expansion-item",{attrs:{label:"Custom Fields","default-opened":"","header-class":"bg-blue-grey-5 text-white","expand-icon-class":"text-white"}},[e.currentVulnerability.details[e.currentDetailsIndex].customFields?i("div",[i("custom-fields",{ref:"customfields",attrs:{"custom-element":"QCardSection"},model:{value:e.currentVulnerability.details[e.currentDetailsIndex].customFields,callback:function(t){e.$set(e.currentVulnerability.details[e.currentDetailsIndex],"customFields",t)},expression:"currentVulnerability.details[currentDetailsIndex].customFields"}})],1):e._e()]),i("q-separator"),i("q-card-actions",{attrs:{align:"right"}},[i("q-btn",{attrs:{color:"primary",outline:""},on:{click:function(t){return e.$refs.updatesModal.hide()}}},[e._v("Cancel")]),i("q-btn",{attrs:{color:"orange",unelevated:"",label:"Update"},on:{click:function(t){return e.updateVulnerability()}}})],1)],1),i("q-card",{staticClass:"col-md-6"},[i("q-card-section",[i("q-tabs",{staticClass:"bg-blue-grey-2",attrs:{dense:"","no-caps":"",align:"left","indicator-color":"primary"},model:{value:e.currentUpdate,callback:function(t){e.currentUpdate=t},expression:"currentUpdate"}},e._l(e.vulnUpdates,(function(t){return i("q-tab",{key:t._id,attrs:{name:t._id,label:t.creator.username},on:{click:function(i){e.currentLanguage=t.locale}}})})),1)],1),i("q-tab-panels",{model:{value:e.currentUpdate,callback:function(t){e.currentUpdate=t},expression:"currentUpdate"}},e._l(e.vulnUpdates,(function(t){return i("q-tab-panel",{key:t._id,staticClass:"q-pa-none",attrs:{name:t._id}},[i("q-card-section",{staticClass:"row q-col-gutter-md q-pt-none"},[i("q-input",{staticClass:"col-md-8",attrs:{label:"Title *","stack-label":"",readonly:"",outlined:"","bg-color":"white"},model:{value:t.title,callback:function(i){e.$set(t,"title",i)},expression:"update.title"}}),i("q-select",{staticClass:"col-md-2",attrs:{"bg-color":e.currentVulnerability.details[e.currentDetailsIndex].vulnType!=t.vulnType?"red-1":"white",label:"Type",options:e.vulnTypesLang,"option-value":"name","option-label":"name","emit-value":"","map-options":"",readonly:"","options-sanitize":"",outlined:""},model:{value:t.vulnType,callback:function(i){e.$set(t,"vulnType",i)},expression:"update.vulnType"}}),i("q-select",{staticClass:"col-md-2",attrs:{label:"Language","stack-label":"",options:e.languages,"option-value":"locale","option-label":"language","emit-value":"","map-options":"",readonly:"","options-sanitize":"",outlined:"","bg-color":"white"},model:{value:t.locale,callback:function(i){e.$set(t,"locale",i)},expression:"update.locale"}})],1),i("q-card-section",[i("q-field",{class:(e.currentVulnerability.details[e.currentDetailsIndex].description||t.description)&&e.currentVulnerability.details[e.currentDetailsIndex].description!=t.description?"bg-red-1":"",attrs:{borderless:"",label:"Description","stack-label":"",readonly:""},scopedSlots:e._u([{key:"default",fn:function(l){return[i("basic-editor",{attrs:{diff:e.currentVulnerability.details[e.currentDetailsIndex].description||"",editable:!1},model:{value:t.description,callback:function(i){e.$set(t,"description",i)},expression:"update.description"}})]}}],null,!0)})],1),i("q-card-section",[i("q-field",{class:(e.currentVulnerability.details[e.currentDetailsIndex].observation||t.observation)&&e.currentVulnerability.details[e.currentDetailsIndex].observation!=t.observation?"bg-red-1":"",attrs:{borderless:"",label:"Observation","stack-label":"",readonly:""},scopedSlots:e._u([{key:"default",fn:function(l){return[i("basic-editor",{attrs:{diff:e.currentVulnerability.details[e.currentDetailsIndex].observation||"",editable:!1},model:{value:t.observation,callback:function(i){e.$set(t,"observation",i)},expression:"update.observation"}})]}}],null,!0)})],1),i("q-card-section",[i("cvss-calculator",{class:e.currentVulnerability.cvssv3!==t.cvssv3?"bg-red-1":"",attrs:{cvssString:t.cvssv3,cvssScore:t.cvssScore,cvssSeverity:t.cvssSeverity},on:{cvssChange:function(e){t.cvssv3=e},cvssScoreChange:function(e){t.cvssScore=e},cvssSeverityChange:function(e){t.cvssSeverity=e}}})],1),i("q-card-section",[i("div",{staticClass:"col-md-12"},[i("risk-calculator",{attrs:{riskProbability:t.riskProbability,riskImpact:t.riskImpact,riskScore:t.riskScore,riskSeverity:t.riskSeverity},on:{riskProbabilityChange:function(e){t.riskProbability=e},riskImpactChange:function(e){t.riskImpact=e},riskScoreChange:function(e){t.riskScore=e},riskSeverityChange:function(e){t.riskSeverity=e}}})],1)]),i("q-card-section",[i("q-field",{class:(e.currentVulnerability.details[e.currentDetailsIndex].remediation||t.remediation)&&e.currentVulnerability.details[e.currentDetailsIndex].remediation!=t.remediation?"bg-red-1":"",attrs:{borderless:"",label:"Remediation","stack-label":"",readonly:""},scopedSlots:e._u([{key:"default",fn:function(l){return[i("basic-editor",{attrs:{diff:e.currentVulnerability.details[e.currentDetailsIndex].remediation||"",editable:!1},model:{value:t.remediation,callback:function(i){e.$set(t,"remediation",i)},expression:"update.remediation"}})]}}],null,!0)})],1),i("q-card-section",{staticClass:"q-col-gutter-md row"},[i("q-select",{staticClass:"col-md-6",attrs:{"bg-color":e.currentVulnerability.remediationComplexity!=t.remediationComplexity?"red-1":"white",label:"Remediation Complexity","stack-label":"",options:[{label:"Easy",value:1},{label:"Medium",value:2},{label:"Complex",value:3}],"map-options":"","emit-value":"",readonly:"","options-sanitize":"",outlined:""},model:{value:t.remediationComplexity,callback:function(i){e.$set(t,"remediationComplexity",i)},expression:"update.remediationComplexity"}}),i("q-select",{staticClass:"col-md-6",attrs:{"bg-color":e.currentVulnerability.priority!=t.priority?"red-1":"white",label:"Remediation Priority","stack-label":"",options:[{label:"Low",value:1},{label:"Medium",value:2},{label:"High",value:3},{label:"Urgent",value:4}],"map-options":"","emit-value":"",readonly:"","options-sanitize":"",outlined:""},model:{value:t.priority,callback:function(i){e.$set(t,"priority",i)},expression:"update.priority"}})],1),i("q-card-section",[i("q-input",{attrs:{"bg-color":e.$_.isEqual(e.currentVulnerability.details[e.currentDetailsIndex].references,t.references)?"":"red-1",label:"References (One per line)","stack-label":"",value:t.references&&t.references.length>0?t.references.join("\n"):"",type:"textarea",readonly:""}})],1),i("q-expansion-item",{attrs:{label:"Custom Fields","default-opened":"","header-class":"bg-blue-grey-5 text-white","expand-icon-class":"text-white"}},[t.customFields?i("div",[i("custom-fields",{ref:"customfields",refInFor:!0,attrs:{"custom-element":"QCardSection",diff:e.currentVulnerability.details[e.currentDetailsIndex].customFields},model:{value:t.customFields,callback:function(i){e.$set(t,"customFields",i)},expression:"update.customFields"}})],1):e._e()])],1)})),1)],1)],1)],1)],1)],1):e._e(),i("q-dialog",{ref:"mergeModal",attrs:{persistent:""}},[i("q-card",{staticClass:"bg-grey-1",staticStyle:{width:"1000px","max-width":"1000px",height:"60vh"}},[i("q-bar",{staticClass:"bg-primary text-white"},[i("span",[e._v("Merge Vulnerabilities")]),i("q-space"),i("q-btn",{attrs:{dense:"",flat:"",icon:"close"},on:{click:function(t){return e.$refs.mergeModal.hide()}}})],1),e.languages.length<2?i("div",[i("q-card-section",[e._v("\n            The goal is to merge different vulnerabilities with different languages into the same vulnerabiliy."),i("br"),e._v("\n            So a minimum of 2 Languages must exist.\n            ")])],1):i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-6 col-6"},[i("q-card-section",{staticClass:"col-md-6"},[i("q-select",{attrs:{label:"Language (Add from right)",options:e.languages,"option-value":"locale","option-label":"language","map-options":"","emit-value":"","options-sanitize":"",outlined:"","bg-color":"white"},on:{input:function(t){e.mergeVulnLeft=""}},model:{value:e.mergeLanguageLeft,callback:function(t){e.mergeLanguageLeft=t},expression:"mergeLanguageLeft"}})],1),i("q-card-section",{staticClass:"card-section-merge"},[i("q-scroll-area",{staticClass:"full-height"},[i("q-list",e._l(e.vulnerabilities,(function(t){return"undefined"===e.getVulnTitleLocale(t,e.mergeLanguageRight)&&"undefined"!==e.getVulnTitleLocale(t,e.mergeLanguageLeft)?i("q-item",{key:t._id,staticClass:"q-pl-none",attrs:{tag:"label",dense:""}},[i("q-item-section",{attrs:{side:"",top:""}},[i("q-radio",{attrs:{val:t._id},model:{value:e.mergeVulnLeft,callback:function(t){e.mergeVulnLeft=t},expression:"mergeVulnLeft"}})],1),i("q-item-section",[i("q-item-label",[e._v(e._s(e.getVulnTitleLocale(t,e.mergeLanguageLeft)))])],1)],1):e._e()})),1)],1)],1)],1),i("q-separator",{attrs:{vertical:""}}),i("div",{staticClass:"col"},[i("q-card-section",[i("q-select",{attrs:{label:"Language (Move to left)",options:e.languages,"option-value":"locale","option-label":"language","map-options":"","emit-value":"","options-sanitize":"",outlined:"","bg-color":"white"},on:{input:function(t){e.mergeVulnRight=""}},model:{value:e.mergeLanguageRight,callback:function(t){e.mergeLanguageRight=t},expression:"mergeLanguageRight"}})],1),i("q-card-section",{staticClass:"card-section-merge"},[i("q-scroll-area",{staticClass:"full-height"},[i("q-list",e._l(e.vulnerabilities,(function(t){return"undefined"===e.getVulnTitleLocale(t,e.mergeLanguageLeft)&&"undefined"!==e.getVulnTitleLocale(t,e.mergeLanguageRight)?i("q-item",{key:t._id,staticClass:"q-pl-none",attrs:{tag:"label",dense:""}},[i("q-item-section",{attrs:{side:"",top:""}},[i("q-radio",{attrs:{val:t._id},model:{value:e.mergeVulnRight,callback:function(t){e.mergeVulnRight=t},expression:"mergeVulnRight"}})],1),i("q-item-section",[i("q-item-label",[e._v(e._s(e.getVulnTitleLocale(t,e.mergeLanguageRight)))])],1)],1):e._e()})),1)],1)],1)],1)],1),i("q-separator"),i("q-card-actions",{attrs:{align:"center"}},[i("q-btn",{attrs:{color:"secondary",unelevated:"",disable:""===e.mergeVulnLeft||""===e.mergeVulnRight},on:{click:e.mergeVulnerabilities}},[e._v("Merge")])],1)],1)],1)],1)},a=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("p",[e._v("No languages are defined. "),i("br"),e._v(" Please create Languages in "),i("a",{attrs:{href:"/datas/custom"}},[e._v("Datas -> Custom Datas -> Languages")])])}],r=i("448a"),n=i.n(r),s=(i("4de4"),i("159b"),i("d81d"),i("b0c0"),i("c740"),i("7db0"),i("ac1f"),i("5319"),i("436b")),o=i("2a19"),c=i("a897"),u=i("b3a4"),d=i("4b40"),b=i("5d6b"),p=i("78af"),g=i("81ab"),y=i("1938"),m=i("ed8e"),v=i("93d6"),f=i("6fbe"),h={data:function(){return{UserService:v["a"],vulnerabilities:[],loading:!0,dtHeaders:[{name:"title",label:"Title",field:"title",align:"left",sortable:!0},{name:"category",label:"Category",field:"category",align:"left",sortable:!0},{name:"type",label:"Type",field:"type",align:"left",sortable:!0},{name:"action",label:"",field:"action",align:"left",sortable:!1}],pagination:{page:1,rowsPerPage:25,sortBy:"title"},rowsPerPageOptions:[{label:"25",value:25},{label:"50",value:50},{label:"100",value:100},{label:"All",value:0}],filteredRowsCount:0,languages:[],locale:"",search:{title:"",type:"",category:"",valid:0,new:1,updates:2},errors:{title:""},currentVulnerability:{cvssv3:"",cvssScore:"",cvssSeverity:"",riskImpact:"",riskProbability:"",riskScore:"",riskSeverity:"",priority:"",remediationComplexity:"",details:[]},currentLanguage:"",displayFilters:{valid:!0,new:!0,updates:!0},dtLanguage:"",currentDetailsIndex:0,vulnerabilityId:"",vulnUpdates:[],currentUpdate:"",currentUpdateLocale:"",vulnTypes:[],mergeLanguageLeft:"",mergeLanguageRight:"",mergeVulnLeft:"",mergeVulnRight:"",vulnCategories:[],currentCategory:null,customFields:[]}},components:{BasicEditor:c["a"],Breadcrumb:u["a"],CvssCalculator:d["a"],RiskCalculator:b["a"],TextareaArray:p["a"],CustomFields:g["a"]},mounted:function(){this.getLanguages(),this.getVulnTypes(),this.getVulnerabilities(),this.getVulnerabilityCategories(),this.getCustomFields()},watch:{currentLanguage:function(e,t){this.setCurrentDetails()}},computed:{vulnTypesLang:function(){var e=this;return this.vulnTypes.filter((function(t){return t.locale===e.currentLanguage}))},computedVulnerabilities:function(){var e=this,t=[];return this.vulnerabilities.forEach((function(i){for(var l=0;l<i.details.length;l++)i.details[l].locale===e.dtLanguage&&i.details[l].title&&t.push(i)})),t},vulnCategoriesOptions:function(){var e=this.vulnCategories.map((function(e){return e.name}));return e.unshift("No Category"),e},vulnTypeOptions:function(){var e=this,t=this.vulnTypes.filter((function(t){return t.locale===e.dtLanguage})).map((function(e){return e.name}));return t.unshift("Undefined"),t}},methods:{getLanguages:function(){var e=this;m["a"].getLanguages().then((function(t){e.languages=t.data.datas,e.languages.length>0&&(e.dtLanguage=e.languages[0].locale,e.cleanCurrentVulnerability())})).catch((function(e){console.log(e)}))},getCustomFields:function(){var e=this;m["a"].getCustomFields().then((function(t){e.customFields=t.data.datas})).catch((function(e){console.log(e)}))},getVulnTypes:function(){var e=this;m["a"].getVulnerabilityTypes().then((function(t){e.vulnTypes=t.data.datas})).catch((function(e){console.log(e)}))},getVulnerabilityCategories:function(){var e=this;m["a"].getVulnerabilityCategories().then((function(t){e.vulnCategories=t.data.datas})).catch((function(e){console.log(e)}))},getVulnerabilities:function(){var e=this;this.loading=!0,y["a"].getVulnerabilities().then((function(t){e.vulnerabilities=t.data.datas,e.loading=!1})).catch((function(e){console.log(e),o["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},createVulnerability:function(){var e=this;this.cleanErrors();var t=this.currentVulnerability.details.findIndex((function(e){return""!==e.title}));t<0&&(this.errors.title="Title required"),this.errors.title||y["a"].createVulnerabilities([this.currentVulnerability]).then((function(){e.getVulnerabilities(),e.$refs.createModal.hide(),o["a"].create({message:"Vulnerability created successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){o["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},updateVulnerability:function(){var e=this;this.cleanErrors();var t=this.currentVulnerability.details.findIndex((function(e){return""!==e.title}));t<0&&(this.errors.title="Title required"),this.errors.title||y["a"].updateVulnerability(this.vulnerabilityId,this.currentVulnerability).then((function(){e.getVulnerabilities(),e.$refs.editModal.hide(),e.$refs.updatesModal.hide(),o["a"].create({message:"Vulnerability updated successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){o["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},deleteVulnerability:function(e){var t=this;y["a"].deleteVulnerability(e).then((function(){t.getVulnerabilities(),o["a"].create({message:"Vulnerability deleted successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){o["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},confirmDeleteVulnerability:function(e){var t=this;s["a"].create({title:"Confirm Suppression",message:"Vulnerability will be permanently deleted",ok:{label:"Confirm",color:"negative"},cancel:{label:"Cancel",color:"white"}}).onOk((function(){return t.deleteVulnerability(e._id)}))},getVulnUpdates:function(e){var t=this;y["a"].getVulnUpdates(e).then((function(e){t.vulnUpdates=e.data.datas,t.vulnUpdates.forEach((function(e){e.customFields=f["a"].filterCustomFields("vulnerability",t.currentVulnerability.category,t.customFields,e.customFields)})),t.vulnUpdates.length>0&&(t.currentUpdate=t.vulnUpdates[0]._id||null,t.currentLanguage=t.vulnUpdates[0].locale||null)})).catch((function(e){console.log(e)}))},clone:function(e){this.cleanCurrentVulnerability(),this.currentVulnerability=this.$_.cloneDeep(e),this.setCurrentDetails(),this.vulnerabilityId=e._id,this.UserService.isAllowed("vulnerabilities:update")&&this.getVulnUpdates(this.vulnerabilityId)},editChangeCategory:function(e){var t=this;s["a"].create({title:"Confirm Category change",message:"Custom Fields display could be riskImpacted when changing Category",ok:{label:"Confirm",color:"negative"},cancel:{label:"Cancel",color:"white"}}).onOk((function(){t.currentVulnerability.category=e?e.name:null,t.setCurrentDetails()}))},cleanErrors:function(){this.errors.title=""},cleanCurrentVulnerability:function(){this.cleanErrors(),this.currentVulnerability.cvssv3="",this.currentVulnerability.cvssScore="",this.currentVulnerability.cvssSeverity="",this.currentVulnerability.priority="",this.currentVulnerability.riskImpact="",this.currentVulnerability.riskProbability="",this.currentVulnerability.riskScore="",this.currentVulnerability.riskSeverity="",this.currentVulnerability.remediationComplexity="",this.currentVulnerability.details=[],this.currentLanguage=this.dtLanguage,this.currentCategory&&this.currentCategory.name?this.currentVulnerability.category=this.currentCategory.name:this.currentVulnerability.category=null,this.setCurrentDetails()},setCurrentDetails:function(e){var t=this,i=this.currentVulnerability.details.findIndex((function(e){return e.locale===t.currentLanguage}));if(i<0){var l={locale:this.currentLanguage,title:"",vulnType:"",description:"",observation:"",remediation:"",references:[],customFields:[]};l.customFields=f["a"].filterCustomFields("vulnerability",this.currentVulnerability.category,this.customFields,[]),this.currentVulnerability.details.push(l),i=this.currentVulnerability.details.length-1}else this.currentVulnerability.details[i].customFields=f["a"].filterCustomFields("vulnerability",this.currentVulnerability.category,this.customFields,this.currentVulnerability.details[i].customFields);this.currentDetailsIndex=i},isTextInCustomFields:function(e){return!!this.currentVulnerability.details[this.currentDetailsIndex].customFields&&"undefined"===typeof this.currentVulnerability.details[this.currentDetailsIndex].customFields.find((function(t){return t.customField===e.customField._id&&t.text===e.text}))},getTextDiffInCustomFields:function(e){var t="";return this.currentVulnerability.details[this.currentDetailsIndex].customFields&&this.currentVulnerability.details[this.currentDetailsIndex].customFields.find((function(i){i.customField===e.customField._id&&(t=i.text)})),t},getDtTitle:function(e){var t=this,i=e.details.findIndex((function(e){return e.locale===t.dtLanguage}));return i<0||!e.details[i].title?"Not defined for this language yet":e.details[i].title},getDtType:function(e){var t=this,i=e.details.findIndex((function(e){return e.locale===t.dtLanguage}));return i<0||!e.details[i].vulnType?"Undefined":e.details[i].vulnType},customSort:function(e,t,i){var l=this;if(e){var a=n()(e);return"type"===t?i?a.sort((function(e,t){return l.getDtType(t).localeCompare(l.getDtType(e))})):a.sort((function(e,t){return l.getDtType(e).localeCompare(l.getDtType(t))})):"title"===t?i?a.sort((function(e,t){return l.getDtTitle(t).localeCompare(l.getDtTitle(e))})):a.sort((function(e,t){return l.getDtTitle(e).localeCompare(l.getDtTitle(t))})):"category"===t&&(i?a.sort((function(e,t){return(t.category||"No Category").localeCompare(e.category||"No Category")})):a.sort((function(e,t){return(e.category||"No Category").localeCompare(t.category||"No Category")}))),a}},customFilter:function(e,t,i,l){var a=this,r=e&&e.filter((function(e){var i=a.getDtTitle(e).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),l=a.getDtType(e).toLowerCase(),r=(e.category||"No Category").toLowerCase(),n=(t.title||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),s=(t.category||"").toLowerCase(),o=(t.type||"").toLowerCase();return i.indexOf(n)>-1&&l.indexOf(o||"")>-1&&r.indexOf(s||"")>-1&&(e.status===t.valid||e.status===t.new||e.status===t.updates)}));return this.filteredRowsCount=r.length,r},goToAudits:function(e){var t=this.getDtTitle(e);this.$router.push({name:"audits",params:{finding:t}})},getVulnTitleLocale:function(e,t){for(var i=0;i<e.details.length;i++)if(e.details[i].locale===t&&e.details[i].title)return e.details[i].title;return"undefined"},mergeVulnerabilities:function(){var e=this;y["a"].mergeVulnerability(this.mergeVulnLeft,this.mergeVulnRight,this.mergeLanguageRight).then((function(){e.getVulnerabilities(),o["a"].create({message:"Vulnerability merge successfully",color:"positive",textColor:"white",position:"top-right"})})).catch((function(e){o["a"].create({message:e.response.data.datas,color:"negative",textColor:"white",position:"top-right"})}))},dblClick:function(e){this.clone(e),this.UserService.isAllowed("vulnerabilities:update")&&2===e.status?this.$refs.updatesModal.show():this.$refs.editModal.show()}}},V=h,C=(i("4628"),i("2877")),k=Object(C["a"])(V,l,a,!1,null,null,null);t["default"]=k.exports}}]);