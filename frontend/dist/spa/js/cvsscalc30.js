var CVSS={CVSSVersionIdentifier:"CVSS:3.0",exploitabilityCoefficient:8.22,scopeCoefficient:1.08,vectorStringRegex_30:/^CVSS:3\.0\/((AV:[NALP]|AC:[LH]|PR:[UNLH]|UI:[NR]|S:[UC]|[CIA]:[NLH]|E:[XUPFH]|RL:[XOTWU]|RC:[XURC]|[CIA]R:[XLMH]|MAV:[XNALP]|MAC:[XLH]|MPR:[XUNLH]|MUI:[XNR]|MS:[XUC]|M[CIA]:[XNLH])\/)*(AV:[NALP]|AC:[LH]|PR:[UNLH]|UI:[NR]|S:[UC]|[CIA]:[NLH]|E:[XUPFH]|RL:[XOTWU]|RC:[XURC]|[CIA]R:[XLMH]|MAV:[XNALP]|MAC:[XLH]|MPR:[XUNLH]|MUI:[XNR]|MS:[XUC]|M[CIA]:[XNLH])$/,Weight:{AV:{N:.85,A:.62,L:.55,P:.2},AC:{H:.44,L:.77},PR:{U:{N:.85,L:.62,H:.27},C:{N:.85,L:.68,H:.5}},UI:{N:.85,R:.62},S:{U:6.42,C:7.52},CIA:{N:0,L:.22,H:.56},E:{X:1,U:.91,P:.94,F:.97,H:1},RL:{X:1,O:.95,T:.96,W:.97,U:1},RC:{X:1,U:.92,R:.96,C:1},CIAR:{X:1,L:.5,M:1,H:1.5}},severityRatings:[{name:"None",bottom:0,top:0},{name:"Low",bottom:.1,top:3.9},{name:"Medium",bottom:4,top:6.9},{name:"High",bottom:7,top:8.9},{name:"Critical",bottom:9,top:10}],calculateCVSSFromMetrics:function(e,i,t,r,o,n,a,_,S,s,C,c,M,p,d,l,v,m,V,A,R,I){var X=[];if("undefined"!==typeof e&&""!==e||X.push("AV"),"undefined"!==typeof i&&""!==i||X.push("AC"),"undefined"!==typeof t&&""!==t||X.push("PR"),"undefined"!==typeof r&&""!==r||X.push("UI"),"undefined"!==typeof o&&""!==o||X.push("S"),"undefined"!==typeof n&&""!==n||X.push("C"),"undefined"!==typeof a&&""!==a||X.push("I"),"undefined"!==typeof _&&""!==_||X.push("A"),X.length>0)return{success:!1,errorType:"MissingBaseMetric",errorMetrics:X};var h=e,y=i,u=t,f=r,g=o,N=n,L=a,U=_,P=S||"X",O=s||"X",E=C||"X",W=c||"X",w=M||"X",H=p||"X",F=d||"X",b=l||"X",x=v||"X",T=m||"X",k=V||"X",D=A||"X",q=R||"X",B=I||"X";if(CVSS.Weight.AV.hasOwnProperty(h)||X.push("AV"),CVSS.Weight.AC.hasOwnProperty(y)||X.push("AC"),CVSS.Weight.PR.U.hasOwnProperty(u)||X.push("PR"),CVSS.Weight.UI.hasOwnProperty(f)||X.push("UI"),CVSS.Weight.S.hasOwnProperty(g)||X.push("S"),CVSS.Weight.CIA.hasOwnProperty(N)||X.push("C"),CVSS.Weight.CIA.hasOwnProperty(L)||X.push("I"),CVSS.Weight.CIA.hasOwnProperty(U)||X.push("A"),CVSS.Weight.E.hasOwnProperty(P)||X.push("E"),CVSS.Weight.RL.hasOwnProperty(O)||X.push("RL"),CVSS.Weight.RC.hasOwnProperty(E)||X.push("RC"),"X"===W||CVSS.Weight.CIAR.hasOwnProperty(W)||X.push("CR"),"X"===w||CVSS.Weight.CIAR.hasOwnProperty(w)||X.push("IR"),"X"===H||CVSS.Weight.CIAR.hasOwnProperty(H)||X.push("AR"),"X"===F||CVSS.Weight.AV.hasOwnProperty(F)||X.push("MAV"),"X"===b||CVSS.Weight.AC.hasOwnProperty(b)||X.push("MAC"),"X"===x||CVSS.Weight.PR.U.hasOwnProperty(x)||X.push("MPR"),"X"===T||CVSS.Weight.UI.hasOwnProperty(T)||X.push("MUI"),"X"===k||CVSS.Weight.S.hasOwnProperty(k)||X.push("MS"),"X"===D||CVSS.Weight.CIA.hasOwnProperty(D)||X.push("MC"),"X"===q||CVSS.Weight.CIA.hasOwnProperty(q)||X.push("MI"),"X"===B||CVSS.Weight.CIA.hasOwnProperty(B)||X.push("MA"),X.length>0)return{success:!1,errorType:"UnknownMetricValue",errorMetrics:X};var G,K,Y=CVSS.Weight.AV[h],J=CVSS.Weight.AC[y],Q=CVSS.Weight.PR[g][u],$=CVSS.Weight.UI[f],j=CVSS.Weight.S[g],z=CVSS.Weight.CIA[N],Z=CVSS.Weight.CIA[L],ee=CVSS.Weight.CIA[U],ie=CVSS.Weight.E[P],te=CVSS.Weight.RL[O],re=CVSS.Weight.RC[E],oe=CVSS.Weight.CIAR[W],ne=CVSS.Weight.CIAR[w],ae=CVSS.Weight.CIAR[H],_e=CVSS.Weight.AV["X"!==F?F:h],Se=CVSS.Weight.AC["X"!==b?b:y],se=CVSS.Weight.PR["X"!==k?k:g]["X"!==x?x:u],Ce=CVSS.Weight.UI["X"!==T?T:f],ce=CVSS.Weight.S["X"!==k?k:g],Me=CVSS.Weight.CIA["X"!==D?D:N],pe=CVSS.Weight.CIA["X"!==q?q:L],de=CVSS.Weight.CIA["X"!==B?B:U],le=CVSS.exploitabilityCoefficient*Y*J*Q*$,ve=1-(1-z)*(1-Z)*(1-ee);K="U"===g?j*ve:j*(ve-.029)-3.25*Math.pow(ve-.02,15),G=K<=0?0:"U"===g?CVSS.roundUp1(Math.min(le+K,10)):CVSS.roundUp1(Math.min((le+K)*CVSS.scopeCoefficient,10));var me,Ve,Ae=CVSS.roundUp1(G*ie*te*re),Re=CVSS.exploitabilityCoefficient*_e*Se*se*Ce,Ie=Math.min(1-(1-Me*oe)*(1-pe*ne)*(1-de*ae),.915);"U"===k||"X"===k&&"U"===g?(Ve=ce*Ie,me=CVSS.roundUp1(CVSS.roundUp1(Math.min(Ve+Re),10)*ie*te*re)):(Ve=ce*(Ie-.029)-3.25*Math.pow(Ie-.02,15),me=CVSS.roundUp1(CVSS.roundUp1(Math.min(CVSS.scopeCoefficient*(Ve+Re),10))*ie*te*re)),Ve<=0&&(me=0);var Xe=CVSS.CVSSVersionIdentifier+"/AV:"+h+"/AC:"+y+"/PR:"+u+"/UI:"+f+"/S:"+g+"/C:"+N+"/I:"+L+"/A:"+U;return"X"!==P&&(Xe=Xe+"/E:"+P),"X"!==O&&(Xe=Xe+"/RL:"+O),"X"!==E&&(Xe=Xe+"/RC:"+E),"X"!==W&&(Xe=Xe+"/CR:"+W),"X"!==w&&(Xe=Xe+"/IR:"+w),"X"!==H&&(Xe=Xe+"/AR:"+H),"X"!==F&&(Xe=Xe+"/MAV:"+F),"X"!==b&&(Xe=Xe+"/MAC:"+b),"X"!==x&&(Xe=Xe+"/MPR:"+x),"X"!==T&&(Xe=Xe+"/MUI:"+T),"X"!==k&&(Xe=Xe+"/MS:"+k),"X"!==D&&(Xe=Xe+"/MC:"+D),"X"!==q&&(Xe=Xe+"/MI:"+q),"X"!==B&&(Xe=Xe+"/MA:"+B),{success:!0,baseMetricScore:G.toFixed(1),baseSeverity:CVSS.severityRating(G.toFixed(1)),temporalMetricScore:Ae.toFixed(1),temporalSeverity:CVSS.severityRating(Ae.toFixed(1)),environmentalMetricScore:me.toFixed(1),environmentalSeverity:CVSS.severityRating(me.toFixed(1)),vectorString:Xe}},calculateCVSSFromVector:function(e){var i={AV:void 0,AC:void 0,PR:void 0,UI:void 0,S:void 0,C:void 0,I:void 0,A:void 0,E:void 0,RL:void 0,RC:void 0,CR:void 0,IR:void 0,AR:void 0,MAV:void 0,MAC:void 0,MPR:void 0,MUI:void 0,MS:void 0,MC:void 0,MI:void 0,MA:void 0},t=[];if(!CVSS.vectorStringRegex_30.test(e))return{success:!1,errorType:"MalformedVectorString"};var r=e.substring(CVSS.CVSSVersionIdentifier.length).split("/");for(var o in r)if(r.hasOwnProperty(o)){var n=r[o].split(":");"undefined"===typeof i[n[0]]?i[n[0]]=n[1]:t.push(n[0])}return t.length>0?{success:!1,errorType:"MultipleDefinitionsOfMetric",errorMetrics:t}:CVSS.calculateCVSSFromMetrics(i.AV,i.AC,i.PR,i.UI,i.S,i.C,i.I,i.A,i.E,i.RL,i.RC,i.CR,i.IR,i.AR,i.MAV,i.MAC,i.MPR,i.MUI,i.MS,i.MC,i.MI,i.MA)},roundUp1:function(e){return Math.ceil(10*e)/10},severityRating:function(e){var i=CVSS.severityRatings.length,t=Number(e);if(isNaN(t))return t;for(var r=0;r<i;r++)if(e>=CVSS.severityRatings[r].bottom&&e<=CVSS.severityRatings[r].top)return CVSS.severityRatings[r].name},XML_MetricNames:{E:{X:"NOT_DEFINED",U:"UNPROVEN",P:"PROOF_OF_CONCEPT",F:"FUNCTIONAL",H:"HIGH"},RL:{X:"NOT_DEFINED",O:"OFFICIAL_FIX",T:"TEMPORARY_FIX",W:"WORKAROUND",U:"UNAVAILABLE"},RC:{X:"NOT_DEFINED",U:"UNKNOWN",R:"REASONABLE",C:"CONFIRMED"},CIAR:{X:"NOT_DEFINED",L:"LOW",M:"MEDIUM",H:"HIGH"},MAV:{N:"NETWORK",A:"ADJACENT_NETWORK",L:"LOCAL",P:"PHYSICAL",X:"NOT_DEFINED"},MAC:{H:"HIGH",L:"LOW",X:"NOT_DEFINED"},MPR:{N:"NONE",L:"LOW",H:"HIGH",X:"NOT_DEFINED"},MUI:{N:"NONE",R:"REQUIRED",X:"NOT_DEFINED"},MS:{U:"UNCHANGED",C:"CHANGED",X:"NOT_DEFINED"},MCIA:{N:"NONE",L:"LOW",H:"HIGH",X:"NOT_DEFINED"}},generateXMLFromMetrics:function(e,i,t,r,o,n,a,_,S,s,C,c,M,p,d,l,v,m,V,A,R,I){var X='<?xml version="1.0" encoding="UTF-8"?>\n<cvssv3.0 xmlns="https://www.first.org/cvss/cvss-v3.0.xsd"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="https://www.first.org/cvss/cvss-v3.0.xsd https://www.first.org/cvss/cvss-v3.0.xsd"\n  >\n\n  <base_metrics>\n    <attack-vector>__AttackVector__</attack-vector>\n    <attack-complexity>__AttackComplexity__</attack-complexity>\n    <privileges-required>__PrivilegesRequired__</privileges-required>\n    <user-interaction>__UserInteraction__</user-interaction>\n    <scope>__Scope__</scope>\n    <confidentiality-riskImpact>__Confidentiality__</confidentiality-riskImpact>\n    <integrity-riskImpact>__Integrity__</integrity-riskImpact>\n    <availability-riskImpact>__Availability__</availability-riskImpact>\n    <base-score>__BaseScore__</base-score>\n    <base-severity>__BaseSeverityRating__</base-severity>\n  </base_metrics>\n\n  <temporal_metrics>\n    <exploit-code-maturity>__ExploitCodeMaturity__</exploit-code-maturity>\n    <remediation-level>__RemediationLevel__</remediation-level>\n    <report-confidence>__ReportConfidence__</report-confidence>\n    <temporal-score>__TemporalScore__</temporal-score>\n    <temporal-severity>__TemporalSeverityRating__</temporal-severity>\n  </temporal_metrics>\n\n  <environmental_metrics>\n    <confidentiality-requirement>__ConfidentialityRequirement__</confidentiality-requirement>\n    <integrity-requirement>__IntegrityRequirement__</integrity-requirement>\n    <availability-requirement>__AvailabilityRequirement__</availability-requirement>\n    <modified-attack-vector>__ModifiedAttackVector__</modified-attack-vector>\n    <modified-attack-complexity>__ModifiedAttackComplexity__</modified-attack-complexity>\n    <modified-privileges-required>__ModifiedPrivilegesRequired__</modified-privileges-required>\n    <modified-user-interaction>__ModifiedUserInteraction__</modified-user-interaction>\n    <modified-scope>__ModifiedScope__</modified-scope>\n    <modified-confidentiality-riskImpact>__ModifiedConfidentiality__</modified-confidentiality-riskImpact>\n    <modified-integrity-riskImpact>__ModifiedIntegrity__</modified-integrity-riskImpact>\n    <modified-availability-riskImpact>__ModifiedAvailability__</modified-availability-riskImpact>\n    <environmental-score>__EnvironmentalScore__</environmental-score>\n    <environmental-severity>__EnvironmentalSeverityRating__</environmental-severity>\n  </environmental_metrics>\n\n</cvssv3.0>\n',h=CVSS.calculateCVSSFromMetrics(e,i,t,r,o,n,a,_,S,s,C,c,M,p,d,l,v,m,V,A,R,I);if(!0!==h.success)return h;var y=X;return y=y.replace("__AttackVector__",CVSS.XML_MetricNames["MAV"][e]),y=y.replace("__AttackComplexity__",CVSS.XML_MetricNames["MAC"][i]),y=y.replace("__PrivilegesRequired__",CVSS.XML_MetricNames["MPR"][t]),y=y.replace("__UserInteraction__",CVSS.XML_MetricNames["MUI"][r]),y=y.replace("__Scope__",CVSS.XML_MetricNames["MS"][o]),y=y.replace("__Confidentiality__",CVSS.XML_MetricNames["MCIA"][n]),y=y.replace("__Integrity__",CVSS.XML_MetricNames["MCIA"][a]),y=y.replace("__Availability__",CVSS.XML_MetricNames["MCIA"][_]),y=y.replace("__BaseScore__",h.baseMetricScore),y=y.replace("__BaseSeverityRating__",h.baseSeverity),y=y.replace("__ExploitCodeMaturity__",CVSS.XML_MetricNames["E"][S||"X"]),y=y.replace("__RemediationLevel__",CVSS.XML_MetricNames["RL"][s||"X"]),y=y.replace("__ReportConfidence__",CVSS.XML_MetricNames["RC"][C||"X"]),y=y.replace("__TemporalScore__",h.temporalMetricScore),y=y.replace("__TemporalSeverityRating__",h.temporalSeverity),y=y.replace("__ConfidentialityRequirement__",CVSS.XML_MetricNames["CIAR"][c||"X"]),y=y.replace("__IntegrityRequirement__",CVSS.XML_MetricNames["CIAR"][M||"X"]),y=y.replace("__AvailabilityRequirement__",CVSS.XML_MetricNames["CIAR"][p||"X"]),y=y.replace("__ModifiedAttackVector__",CVSS.XML_MetricNames["MAV"][d||"X"]),y=y.replace("__ModifiedAttackComplexity__",CVSS.XML_MetricNames["MAC"][l||"X"]),y=y.replace("__ModifiedPrivilegesRequired__",CVSS.XML_MetricNames["MPR"][v||"X"]),y=y.replace("__ModifiedUserInteraction__",CVSS.XML_MetricNames["MUI"][m||"X"]),y=y.replace("__ModifiedScope__",CVSS.XML_MetricNames["MS"][V||"X"]),y=y.replace("__ModifiedConfidentiality__",CVSS.XML_MetricNames["MCIA"][A||"X"]),y=y.replace("__ModifiedIntegrity__",CVSS.XML_MetricNames["MCIA"][R||"X"]),y=y.replace("__ModifiedAvailability__",CVSS.XML_MetricNames["MCIA"][I||"X"]),y=y.replace("__EnvironmentalScore__",h.environmentalMetricScore),y=y.replace("__EnvironmentalSeverityRating__",h.environmentalSeverity),{success:!0,xmlString:y}},generateXMLFromVector:function(e){var i={AV:void 0,AC:void 0,PR:void 0,UI:void 0,S:void 0,C:void 0,I:void 0,A:void 0,E:void 0,RL:void 0,RC:void 0,CR:void 0,IR:void 0,AR:void 0,MAV:void 0,MAC:void 0,MPR:void 0,MUI:void 0,MS:void 0,MC:void 0,MI:void 0,MA:void 0},t=[];if(!CVSS.vectorStringRegex_30.test(e))return{success:!1,errorType:"MalformedVectorString"};var r=e.substring(CVSS.CVSSVersionIdentifier.length).split("/");for(var o in r)if(r.hasOwnProperty(o)){var n=r[o].split(":");"undefined"===typeof i[n[0]]?i[n[0]]=n[1]:t.push(n[0])}return t.length>0?{success:!1,errorType:"MultipleDefinitionsOfMetric",errorMetrics:t}:CVSS.generateXMLFromMetrics(i.AV,i.AC,i.PR,i.UI,i.S,i.C,i.I,i.A,i.E,i.RL,i.RC,i.CR,i.IR,i.AR,i.MAV,i.MAC,i.MPR,i.MUI,i.MS,i.MC,i.MI,i.MA)}};